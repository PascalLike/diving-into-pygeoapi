
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="pygeoapi is an OGC Reference Implementation supporting numerous OGC API specifications. This workshop will cover publishing geospatial data to the Web using pygeoapi in support of the suite of OGC API standards.">
      
      
        <meta name="author" content="The pygeoapi community">
      
      
        <link rel="canonical" href="https://geopython.github.io/diving-into-pygeoapi/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Print Site - Diving into pygeoapi</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/pygeoapi.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/termynal.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/custom.css">
    
    <script>__md_scope=new URL("/diving-into-pygeoapi/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pygeoapi" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#index" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Diving into pygeoapi" class="md-header__button md-logo" aria-label="Diving into pygeoapi" data-md-component="logo">
      
  <img src="../assets/images/pygeoapi-icon-notrans.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Diving into pygeoapi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/geopython/diving-into-pygeoapi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Diving into pygeoapi" class="md-nav__button md-logo" aria-label="Diving into pygeoapi" data-md-component="logo">
      
  <img src="../assets/images/pygeoapi-icon-notrans.png" alt="logo">

    </a>
    Diving into pygeoapi
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/geopython/diving-into-pygeoapi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to pygeoapi
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workshop environment setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../publishing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Publishing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Publishing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/first/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 1 - Your first dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 2 - Vector data via OGC API - Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-coverages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 3 - Raster data via OGC API - Coverages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-maps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 4 - Maps of geospatial data via OGC API - Maps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-tiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 5 - Tiles of geospatial data via OGC API - Tiles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 6 - Metadata via OGC API - Records
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-edr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 7 - Environmental data via OGC API - Environmental Data Retrieval
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/ogcapi-processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 8 - Functions via OGC API - Processes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../advanced/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Advanced topics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/i18n/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilingual support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/crs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CRS support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/ui-custom-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UI customization and templating
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/downstream-applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using pygeoapi in downstream applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/seo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search Engine Optimization (SEO)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/security-access-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security and access control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/semantic-web-linked-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic Web and Linked Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/cloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/inspire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    INSPIRE support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/bridges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exercise 9 - pygeoapi as a bridge to other services
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conclusion
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      1 Home
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      2 Introduction to pygeoapi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      3 Workshop environment setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standards" class="md-nav__link">
    <span class="md-ellipsis">
      4 Standards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5" class="md-nav__link">
    <span class="md-ellipsis">
      5 Publishing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5 Publishing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publishing" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Publishing data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-first" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Exercise 1 - Your first dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-features" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Exercise 2 - Vector data via OGC API - Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-coverages" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Exercise 3 - Raster data via OGC API - Coverages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-maps" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 Exercise 4 - Maps of geospatial data via OGC API - Maps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-tiles" class="md-nav__link">
    <span class="md-ellipsis">
      5.6 Exercise 5 - Tiles of geospatial data via OGC API - Tiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-records" class="md-nav__link">
    <span class="md-ellipsis">
      5.7 Exercise 6 - Metadata via OGC API - Records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-edr" class="md-nav__link">
    <span class="md-ellipsis">
      5.8 Exercise 7 - Environmental data via OGC API - Environmental Data Retrieval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publishing-ogcapi-processes" class="md-nav__link">
    <span class="md-ellipsis">
      5.9 Exercise 8 - Functions via OGC API - Processes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-6" class="md-nav__link">
    <span class="md-ellipsis">
      6 Advanced topics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 Advanced topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advanced" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 Advanced topics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-i18n" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 Multilingual support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-crs" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 CRS support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-ui-custom-templates" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 UI customization and templating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-downstream-applications" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 Using pygeoapi in downstream applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-seo" class="md-nav__link">
    <span class="md-ellipsis">
      6.6 Search Engine Optimization (SEO)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-security-access-control" class="md-nav__link">
    <span class="md-ellipsis">
      6.7 Security and access control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-semantic-web-linked-data" class="md-nav__link">
    <span class="md-ellipsis">
      6.8 Semantic Web and Linked Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      6.9 Cloud deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-inspire" class="md-nav__link">
    <span class="md-ellipsis">
      6.10 INSPIRE support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-administration" class="md-nav__link">
    <span class="md-ellipsis">
      6.11 Administration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-bridges" class="md-nav__link">
    <span class="md-ellipsis">
      6.12 Exercise 9 - pygeoapi as a bridge to other services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      7 Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index" heading-number="1"><h1 id="index-welcome-to-the-diving-into-pygeoapi-workshop">Welcome to the Diving into pygeoapi workshop!</h1>
<p>Version: 1.6.0</p>
<p><img alt="pygeoapi logo" src="../assets/images/pygeoapi-logo.png" /></p>
<p><a href="https://pygeoapi.io">pygeoapi</a> is a Python server implementation of the <a href="https://ogcapi.ogc.org">OGC API</a> suite of standards. The project emerged as part of the next generation OGC API efforts in 2018 and provides the capability for organizations to deploy a RESTful OGC API endpoint using OpenAPI, GeoJSON, and HTML. pygeoapi is open source and released under an MIT license.</p>
<p><strong>Diving into pygeoapi</strong> is a half day workshop designed for users to become familiar with installing, configuring, publishing data to and extending pygeoapi. This workshop will cover publishing geospatial data to the Web using pygeoapi in support of the suite of OGC API standards.</p>
<p>This workshop covers a wide range of topics (install/setup/configuration, publishing, cloud, templating, plugins, etc.). Please see the left hand navigation for the table of contents.</p>
<h1 id="index-your-foss4g-eu-2025-workshop-team">Your <a href="https://2025.europe.foss4g.org/">FOSS4G-EU 2025</a> workshop team</h1>
<table>    
    <tr>
        <td><a href="https://github.com/tomkralidis"><img width="150" src="https://avatars.githubusercontent.com/u/910430?v=4"/></a></td>
        <td><a href="https://github.com/justb4"><img width="150" src="https://avatars.githubusercontent.com/u/582630?v=4"/></a></td>
        <td><a href="https://github.com/pvgenuchten"><img width="150" src="https://avatars.githubusercontent.com/u/299829?v=4"/></a></td>
        <td><a href="https://github.com/geographika"><img width="150" src="https://avatars.githubusercontent.com/u/490840?v=4"/></a></td>
        <td><a href="https://github.com/ldesousa"><img width="150" src="https://avatars.githubusercontent.com/u/1137878?v=4"/></a></td>
    </tr>
    <tr>
        <td><a href="https://github.com/tomkralidis">Tom Kralidis</a></td>
        <td><a href="https://github.com/justb4">Just van den Broecke</a></td>
        <td><a href="https://github.com/pvgenuchten">Paul van Genuchten</a></td>
        <td><a href="https://github.com/geographika">Seth Girvin</a></td>
        <td><a href="https://github.com/ldesousa">Luís de Sousa</td>
    </tr>
</table>

<h1 id="index-about-this-tutorial">About this tutorial</h1>
<p>This tutorial is a combination of step-by-step explanations of various aspects of pygeoapi as well as a series of exercises to familiarize yourself with the project.</p>
<p>Exercises are indicated as follows:</p>
<div class="admonition question">
<p class="admonition-title">Example exercise</p>
<p>A section marked like this indicates that you can try out the exercise.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example exercise with tabs</p>
<p>A section marked like this indicates that you can try out the exercise and choose your environment (Linux/Mac or Windows).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="index-__tabbed_1_1" name="index-__tabbed_1" type="radio" /><input id="index-__tabbed_1_2" name="index-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="index-__tabbed_1_1">Linux/Mac</label><label for="index-__tabbed_1_2">Windows</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>Also you will notice tips and notes sections within the text:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Tips share additional help on how to best achieve tasks</p>
</div>
<p>Examples are indicated as follows:</p>
<p>Code
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>This is an HTML sample<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div></p>
<p>Configuration
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">my-collection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my cool collection title</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my cool collection description</span>
</code></pre></div></td></tr></table></div></p>
<p>Snippets which need to be typed in a on a terminal/console are indicated as:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Hello world&#39;</span>
</code></pre></div>
</div>

<h1 id="index-workshop-location-and-materials">Workshop location and materials</h1>
<p>This workshop is always provided live at <a href="https://dive.pygeoapi.io">https://dive.pygeoapi.io</a>.</p>
<p>The workshop contents, wiki and issue tracker are managed on GitHub at <a href="https://github.com/geopython/diving-into-pygeoapi">https://github.com/geopython/diving-into-pygeoapi</a>.</p>
<h2 id="index-printing-this-workshop">Printing this workshop</h2>
<p>To print this workshop, navigate to the <a href="#print_page">print page</a> and select <em>File &gt; Print &gt; Save as PDF</em>.</p>
<h1 id="index-support">Support</h1>
<p>A <a href="https://app.gitter.im/#/room/#geopython_diving-into-pygeoapi:gitter.im">Gitter</a> channel exists for
discussion and live support from the developers of the workshop and other workshop participants.</p>
<p>For issues/bugs/suggestions or improvements/contributions, please use the <a href="https://github.com/geopython/diving-into-pygeoapi/issues">GitHub issue tracker</a>.</p>
<p>All bugs, enhancements and issues can be reported on <a href="https://github.com/geopython/diving-into-pygeoapi/issues">GitHub</a>.</p>
<p>As always, core pygeoapi support and community information can be found on the pygeoapi <a href="https://pygeoapi.io/community">website</a>.</p>
<p>Contributions are always enncouraged and welcome!</p>
<h2 id="index-now-on-to-the-workshop-lets-go">Now, on to the workshop.  Let's go!</h2></section><section class="print-page" id="introduction" heading-number="2"><h1 id="introduction-introduction-to-pygeoapi">Introduction to pygeoapi</h1>
<p>The development team of pygeoapi (yes, spelled in lowercase) is excited to welcome you in this workshop! </p>
<p>In this half day workshop, we will give you an introduction to pygeoapi, how to publish data, and provide
resources and tips for future reading and reference (i.e. where to go when you don't know!).</p>
<p>Although pygeoapi is written in Python and can be customizable and extensible (plugins) 
for Python developers, Python skills are not required to install, setup and publish your geospatial
data as part of this workshop. All you need for the workshop is your favorite text editor and Docker (we will
more information in the <a href="#setup">setup section</a>).</p>
<h2 id="introduction-background-reading">Background reading</h2>
<p>The pygeoapi <a href="https://pygeoapi.io">website</a> is the main entrypoint for both end-users and developers
where you can find:</p>
<ul>
<li><a href="https://docs.pygeoapi.io">official documentation</a></li>
<li>the <a href="https://pygeoapi.io/presentations/default">default</a> and <a href="https://pygeoapi.io/presentations/foss4g2023">latest</a> presentations</li>
<li><a href="https://pygeoapi.io/documentation">documentation and presentations archive</a></li>
<li>code on <a href="https://github.com/geopython/pygeoapi">GitHub</a></li>
<li>Docker images <a href="https://hub.docker.com/r/geopython/pygeoapi">available on Docker Hub</a></li>
<li>pygeoapi releases in the <a href="https://pypi.org/project/pygeoapi">Python Package Index (PyPI)</a></li>
</ul>
<p>Given pygeoapi implements a number of OGC API standards, you may also want to read about these
on <a href="https://ogcapi.ogc.org">ogcapi.ogc.org</a>.</p>
<h2 id="introduction-existing-deployments">Existing Deployments</h2>
<p>A number of organizations have deployed pygeoapi to their operations. To get a feel of how pygeoapi
is used in practice, check out our up to date <a href="https://github.com/geopython/pygeoapi/wiki/LiveDeployments">live deployments page</a>. By
default, the pygeoapi public demo at <a href="https://demo.pygeoapi.io">demo.pygeoapi.io</a> is always maintained
and made available by the development team. Check out the <a href="https://demo.pygeoapi.io/master">main instance</a> which
always runs the latest GitHub version.</p>
<p>Interested in the demo site setup itself? <a href="https://demo.pygeoapi.io">demo.pygeoapi.io</a> is developed in a <a href="https://github.com/geopython/demo.pygeoapi.io">GitHub repository</a> using a
DevOps continuous deployment (CD) workflow.
Even more recent GitOps deployments were developed for <a href="https://github.com/Geonovum/ogc-api-testbed">Geonovum</a> and the <a href="https://github.com/justb4/ogc-api-jrc">European Commission Joint Research Center</a>.</p>
<p>The above examples may help as starting points for your own pygeoapi setup and deployment, so feel free to study and use them!</p>
<h2 id="introduction-history">History</h2>
<p>Starting in 2018, pygeoapi emerged as part of the initial efforts for the development of OGC API standards. OGC API
code sprints were instrumental for agile development and pouring the foundation of the project.</p>
<p>The core design principles are as follows:</p>
<ul>
<li>simplicity / low barrier to entry</li>
<li>long term sustainability</li>
<li>modularity</li>
<li>extensibility</li>
<li>building on a large ecosystem of Free Open Source and OSGeo components such as GDAL, rasterio, Shapely, Pandas, Elasticsearch, PostGIS and many others</li>
</ul>
<p>The project was initiated by <a href="https://github.com/tomkralidis">Tom Kralidis</a>. Within weeks, several talented
developers joined the project, which led to the formation of a core team and <a href="https://pygeoapi.io/community/psc">Project Steering Committee (PSC)</a>. Contributions continued
as well from additional developers and users who happily provided new functionality, bug fixes, and documentation
updates. As a result, a healthy community quickly emerged with a common interest in open source, OGC API standards, low barrier, modular and extensible. The
rest, as they say, is history.</p>
<p>pygeoapi is an <a href="https://www.osgeo.org/projects/pygeoapi">OSGeo Project</a> and an OGC Reference Implementation.</p></section><section class="print-page" id="setup" heading-number="3"><h1 id="setup-workshop-environment-setup">Workshop environment setup</h1>
<p>In this workshop we use the following materials:</p>
<ol>
<li><strong>Documentation</strong> - (like this page): access latest on <a href="https://dive.pygeoapi.io">dive.pygeoapi.io</a></li>
<li><strong>Exercises</strong> - download the <a href="https://github.com/geopython/diving-into-pygeoapi/archive/refs/heads/main.zip">latest zip file</a>, unzip, find exercises in <code>workshop/exercises</code> <sup id="fnref:1"><a class="footnote-ref" href="#setup-fn:1">2</a></sup></li>
<li><strong>Docker</strong> - all examples/exercises are run in a <code>Docker container</code> in <code>workshop/exercises</code></li>
</ol>
<h2 id="setup-text-editor">Text editor</h2>
<p>Your text editor needs to be able to edit configuration files in <strong>plain text</strong>. Below are some choices
for text editors (there may be others), along with what some of the pygeoapi developers prefer to use:</p>
<ul>
<li>Notepad or Notepad++ (Windows)</li>
<li>Sublime Text: Angelos</li>
<li>PyCharm: Just</li>
<li>Emacs: Just</li>
<li>Visual Studio Code: Francesco, Angelos, Joana</li>
<li><code>vi</code> / <code>vim</code>: Tom, Angelos</li>
</ul>
<p>Having said this, please feel free to use what works for you :)</p>
<h2 id="setup-yaml">YAML</h2>
<p>Most exercises will focus on editing the pygeoapi <a href="https://docs.pygeoapi.io/en/latest/configuration.html">configuration</a>,
which is in the <a href="https://yaml.org">YAML</a> format. If you are not familiar with YAML, it is worth reading through a <a href="https://www.cloudbees.com/blog/yaml-tutorial-everything-you-need-get-started">tutorial</a> to become aware of YAML syntax and indentation.</p>
<p>The main requirement for the training is to install Docker and/with Docker Compose on your system.
We strongly advise to install Docker before the workshop starts.</p>
<p>Although several custom installation scenarios are possible (see the <a href="https://docs.pygeoapi.io/en/latest/installation.html">documentation</a>
for more information), these are not considered in this workshop given the ability to install a fully reproducible
environment via Docker and Docker Compose.</p>
<p>Workshop Exercises will also be based on Docker, hence a custom installation would at least be 'challenging'.
The good news is that only a single installation (Docker) is needed! The Docker images used in this workshop
contain the latest pygeoapi and all its dependencies and external services (e.g. PostGIS).</p>
<h2 id="setup-about-docker">About Docker</h2>
<p>Docker has been available since 2013, and provided as a deployment option on numerous FOSS software and OSGeo projects. Given the current
era of computing, chances are that you have heard of Docker and <em>containerization</em>. Or, perhaps are already familiar and hopefully using Docker already.
If not, there is an abundance of introductory materials that can be found online like this <a href="https://www.ibm.com/topics/docker">tutorial from IBM</a>.</p>
<p>FOSS4G software has benefitted greatly from Docker (consistent packaging, isolation, integration and upgrade patterns) in
comparison to custom installations. Though today we mainly use Docker, the bigger picture is the use of <strong>Containers</strong> as a next step
in virtualization. Containerization certainly deserves its own workshop, so for the purpose of this workshop we only cover the basics
of Docker and Docker Compose.</p>
<p><a href="https://docs.docker.com/compose">Docker Compose</a> is an addition to Docker to facilitate
the orchestration (configuration) of one or more Docker 'Containers' (a Container is a running instance of a Docker image)
using a configuration convention (the Docker Compose YAML file), usually named <code>docker-compose.yml</code>.</p>
<p>Stepping up further are even more sophisticated Docker orchestrators like 
<a href="https://rancher.com/products/rancher">Rancher</a> and <a href="https://kubernetes.io">Kubernetes</a>, but for
this workshop, Docker and Docker Compose are all we need.</p>
<h2 id="setup-installation">Installation</h2>
<p>Docker installation has greatly progressed over the years. This is the only part of the workshop
which is dependent on the system/OS you are running (e.g. Windows, Mac or Linux). For each
system the Docker website provides detailed installation instructions. Please follow these consistently.</p>
<p>For many platforms a product called <a href="https://docs.docker.com/desktop">Docker Desktop</a> is available, which includes the main Docker components:</p>
<ul>
<li>Windows <a href="https://docs.Docker.com/desktop/install/windows-install">installation</a></li>
<li>Mac <a href="https://docs.Docker.com/desktop/install/mac-install">installation</a></li>
<li>Linux <a href="https://docs.Docker.com/desktop/install/linux-install">installation</a></li>
</ul>
<p>Some notes:</p>
<ul>
<li>On Windows we recommend using the <a href="https://docs.microsoft.com/en-us/windows/wsl">Windows Subsystem for Linux</a> (WSL) as it also provides a powerful (Bash) command line and has optimal integration with Docker.  Before installing Docker Desktop, install WSL by opening Microsoft PowerShell (run as administrator) and running <code>wsl --install</code><ul>
<li><strong>installing WSL requires administrator privileges on your system</strong></li>
</ul>
</li>
<li>On Mac, if you are using <a href="https://brew.sh">Homebrew</a>, consider (as the author has) using the <a href="https://formulae.brew.sh/formula/Docker">brew Docker formula</a></li>
<li>On Mac OSX Monterey and later, there may be an issue with local port 5000 already in use, therefore conflicting with the default one used by the pygeoapi container. If you see this error <code>OSError: [Errno 48] Address already in use</code>, you need to disable the <em>Airplay Receiver</em>. Go to <code>System Settings | Sharing</code> or like in Sonoma type 'airplay' in the search box. See image below for Mac OSX Sonoma. Also a detailed description in <a href="https://progressstory.com/tech/port-5000-already-in-use-macos-monterey-issue/">this blog post</a>.
<img alt="MacBook settings" src="../assets/images/macosx-airplay-disable.png" /></li>
<li>On Linux, you can choose the relevant installer for your platform. You can also use Virtualbox with a Ubuntu Image or use a cloud VM</li>
<li>On Linux, when encountering permission issues: the Docker daemon normally runs as "root". This requires prefixing commands with <code>sudo</code> as a non-root user. On most distributions Docker is accessible by users in the <code>docker</code> group. You can omit the use of <code>sudo</code> and prevent possibly other permission issues as follows:<ul>
<li>Test if the <code>docker</code> group exists: <code>cat /etc/group | grep docker</code>.</li>
<li>When non-existing: <code>sudo groupadd docker</code>. </li>
<li>Add your user to this group: <code>sudo usermod -aG docker $USER</code> </li>
<li>Log-out and log-in.</li>
<li>See all details and more options in <a href="https://docs.docker.com/engine/install/linux-postinstall/#manage-docker-as-a-non-root-user">this instruction</a>.</li>
</ul>
</li>
<li>Docker Desktop includes a graphical user interface with some interesting options. You can see logs and information about running containers, open their service in a browser or even open a terminal inside the container</li>
</ul>
<p>If all goes well, you should be able to run Docker from the command line as follows: <sup id="fnref:2"><a class="footnote-ref" href="#setup-fn:2">1</a></sup></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="setup-__tabbed_1_1" name="setup-__tabbed_1" type="radio" /><input id="setup-__tabbed_1_2" name="setup-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="setup-__tabbed_1_1">Linux/Mac</label><label for="setup-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>version
Docker<span class="w"> </span>version<span class="w"> </span><span class="m">20</span>.10.17,<span class="w"> </span>build<span class="w"> </span>100c701

docker<span class="w"> </span>compose<span class="w"> </span>version
Docker<span class="w"> </span>Compose<span class="w"> </span>version<span class="w"> </span>v2.6.1
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>version
Docker<span class="w"> </span>version<span class="w"> </span><span class="m">20</span>.10.17,<span class="w"> </span>build<span class="w"> </span>100c701

docker<span class="w"> </span>compose<span class="w"> </span>version
Docker<span class="w"> </span>Compose<span class="w"> </span>version<span class="w"> </span>v2.6.1
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>(It is not required that your version numbers exactly match).</p>
<h2 id="setup-quickstart">Quickstart</h2>
<p>Once Docker is available on your system, running the pygeoapi container with its built-in configuration and 
data is a one-liner. </p>
<p>Open a terminal session and run:</p>
<div class="admonition question">
<p class="admonition-title">First run via Docker</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="setup-__tabbed_2_1" name="setup-__tabbed_2" type="radio" /><input id="setup-__tabbed_2_2" name="setup-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="setup-__tabbed_2_1">Linux/Mac</label><label for="setup-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;geopython/pygeoapi:latest&#39;</span><span class="w"> </span>locally
latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>geopython/pygeoapi
d7bfe07ed847:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
d5d0144a7164:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
afe0923a0fa0:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
75f8618c4e86:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
c603397fd6ad:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6584a95328b3:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
fd93e44631d9:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6a3201071a5d:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
4f4fb700ef54:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
Digest:<span class="w"> </span>sha256:27b2b219497a6ea382a946ee90ae96ad00b5c1d8e9b725fccf23211978fef124
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>geopython/pygeoapi:latest
START<span class="w"> </span>/entrypoint.sh
Trying<span class="w"> </span>to<span class="w"> </span>generate<span class="w"> </span>openapi.yml
openapi.yml<span class="w"> </span>generated<span class="w"> </span><span class="k">continue</span><span class="w"> </span>to<span class="w"> </span>pygeoapi
make<span class="w"> </span>SCRIPT_NAME<span class="w"> </span>empty<span class="w"> </span>from<span class="w"> </span>/
Start<span class="w"> </span>gunicorn<span class="w"> </span><span class="nv">name</span><span class="o">=</span>pygeoapi<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>workers<span class="w"> </span>and<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>gunicorn<span class="w"> </span><span class="m">20</span>.0.4
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Listening<span class="w"> </span>at:<span class="w"> </span>http://0.0.0.0:80<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>worker:<span class="w"> </span>gevent
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">18</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">18</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">19</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">19</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">21</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">21</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">22</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">22</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;geopython/pygeoapi:latest&#39;</span><span class="w"> </span>locally
latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>geopython/pygeoapi
d7bfe07ed847:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
d5d0144a7164:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
afe0923a0fa0:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
75f8618c4e86:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
c603397fd6ad:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6584a95328b3:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
fd93e44631d9:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
6a3201071a5d:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
4f4fb700ef54:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
Digest:<span class="w"> </span>sha256:27b2b219497a6ea382a946ee90ae96ad00b5c1d8e9b725fccf23211978fef124
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>geopython/pygeoapi:latest
START<span class="w"> </span>/entrypoint.sh
Trying<span class="w"> </span>to<span class="w"> </span>generate<span class="w"> </span>openapi.yml
openapi.yml<span class="w"> </span>generated<span class="w"> </span><span class="k">continue</span><span class="w"> </span>to<span class="w"> </span>pygeoapi
make<span class="w"> </span>SCRIPT_NAME<span class="w"> </span>empty<span class="w"> </span>from<span class="w"> </span>/
Start<span class="w"> </span>gunicorn<span class="w"> </span><span class="nv">name</span><span class="o">=</span>pygeoapi<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80<span class="w"> </span>with<span class="w"> </span><span class="m">4</span><span class="w"> </span>workers<span class="w"> </span>and<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>gunicorn<span class="w"> </span><span class="m">20</span>.0.4
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Listening<span class="w"> </span>at:<span class="w"> </span>http://0.0.0.0:80<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>worker:<span class="w"> </span>gevent
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">18</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">18</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">19</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">19</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">21</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">21</span>
<span class="o">[</span><span class="m">2022</span>-08-09<span class="w"> </span><span class="m">12</span>:59:00<span class="w"> </span>+0000<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">22</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Booting<span class="w"> </span>worker<span class="w"> </span>with<span class="w"> </span>pid:<span class="w"> </span><span class="m">22</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>That's all! Open your browser and navigate to <code>http://localhost:5000</code>, the pygeoapi page will display.
As part of the initial <code>docker run</code>, Docker will download the pygeoapi Docker Image from <a href="https://hub.Docker.com/r/geopython/pygeoapi">Docker Hub</a>.
This may take some time, as the Docker image includes all dependencies (such as GDAL, etc.). Be patient! This is a one-time download for the entire workshop, or
you may want to do this beforehand. </p>
<p>Some notes:</p>
<ul>
<li>Docker runs a pygeoapi container on your local system on port 5000, which is mapped to port 80 inside the container</li>
<li>the pygeoapi Docker container runs with the <a href="https://github.com/geopython/pygeoapi/blob/master/docker/default.config.yml">default configuration</a> and data from the GitHub repo </li>
<li>both configuration and data (from GitHub repo) is embedded in the Docker Image - we will override these later</li>
<li>the <code>--rm</code> option removes the Docker Container (but not the image), after execution</li>
<li>type <code>CTRL-C</code> to stop the container and return to the terminal</li>
</ul>
<p>Next, you can override the default configuration and add your own data using <a href="https://docs.Docker.com/storage/volumes">Docker volumes</a>.</p>
<h2 id="setup-customizing-configuration">Customizing configuration</h2>
<p>In the upcoming exercises we are going to update the configuration file multiple times.
For ease of development we are overriding the pygeoapi configuration which resides by default at <code>/pygeoapi/local.config.yml</code>
within the container by a local file which you can edit in your favourite text editor. </p>
<div class="admonition question">
<p class="admonition-title">Override the pygeoapi config file</p>
<p>Download pygeoapi's default Docker configuration from <a href="https://raw.githubusercontent.com/geopython/pygeoapi/master/docker/default.config.yml">default.config.yml</a> to the current folder (or navigate to the folder where you downloaded the file), for example with:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="setup-__tabbed_3_1" name="setup-__tabbed_3" type="radio" /><input id="setup-__tabbed_3_2" name="setup-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="setup-__tabbed_3_1">Linux/Mac</label><label for="setup-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/docker/default.config.yml
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/docker/default.config.yml
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Open the file in your favourite text editor and change the title and description of the API:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code>metadata:
    identification:
        title: My first pygeoapi run
        description: pygeoapi provides an API to geospatial data
</code></pre></div></td></tr></table></div>
<p>Now run the container with the overridden config file:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="setup-__tabbed_4_1" name="setup-__tabbed_4" type="radio" /><input id="setup-__tabbed_4_2" name="setup-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="setup-__tabbed_4_1">Linux/Mac</label><label for="setup-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span><span class="se">\</span>
geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/default.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>At this point, navigate to <code>http://localhost:5000</code> to verify the new title and description.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Windows, the file downloaded may be renamed to <code>default.config.yml.txt</code>.  Ensure to rename the file to <code>default.config.yml</code>.</p>
</div>
<p>By using a Docker volume mount (<code>-v</code> option), Docker attaches or 'mounts' a
directory or single file from your host/local system into the Docker Container.</p>
<p>In the above snippet, <code>$(pwd)</code> indicates the working folder from which you start the Docker container.</p>
<h2 id="setup-adding-data-and-setting-the-configuration-file">Adding data and setting the configuration file</h2>
<p>In addition to adapting the configuration you will usually add your own data as files or
remote data services like PostGIS or WFS.</p>
<p>You can also mount a local directory such as <code>data/</code> to <code>/pygeoapi/mydata</code> within the Container.
Within the data directory you can store vector data, raster files or sets of image of vector tiles.</p>
<p>Below is an example where the configuration is explicitly set to <code>pygeoapi-config.yml</code> via an environment variable (<code>-e</code>) and uses a Docker mount to mount the local <code>data</code> folder as <code>/pygeoapi/mydata</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="setup-__tabbed_5_1" name="setup-__tabbed_5" type="radio" /><input id="setup-__tabbed_5_2" name="setup-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="setup-__tabbed_5_1">Linux/Mac</label><label for="setup-__tabbed_5_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/pygeoapi/mydata<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/default.config.yml:/pygeoapi/pygeoapi-config.yml<span class="w"> </span><span class="se">\</span>
-e<span class="w"> </span><span class="nv">PYGEOAPI_CONFIG</span><span class="o">=</span>/pygeoapi/pygeoapi-config.yml<span class="w"> </span><span class="se">\</span>
geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/pygeoapi/mydata<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/default.config.yml:/pygeoapi/pygeoapi-config.yml<span class="w"> </span>-e<span class="w"> </span><span class="nv">PYGEOAPI_CONFIG</span><span class="o">=</span>/pygeoapi/pygeoapi-config.yml<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>In the next sections we will review additional examples of mounts to the data folder. More Docker deployment examples can be found in the <a href="https://github.com/geopython/pygeoapi/tree/master/docker/examples">pygeoapi GitHub repository</a>.</p>
<h2 id="setup-using-docker-for-python-clients">Using Docker for Python Clients</h2>
<p>In some exercises we access <code>pygeoapi</code> remote endpoints using <a href="https://owslib.readthedocs.io">OWSLib</a>, 
a Python library to interact with OGC Web Services. OWSLib can be installed using standard 
Python <code>pip3 install OWSLib</code>, but you may not have Python available, or you want to keep your system 'clean'.</p>
<p>As Docker is already available on your system, you can start up a 
Container with a complete Python environment, and access it from a <code>bash</code> shell prompt. 
The magic line is:</p>
<p><code>docker run -it --rm --network=host --name owslib python:3.10-slim /bin/bash</code></p>
<p>This will pull a small (125MB) official Python Docker Image. When the Container is started, you are directed into 
a <code>bash</code> session/prompt. The argument <code>--network=host</code> allows you to directly interact with services on your
host system, thus with <code>pygeoapi</code>, without setting up a Docker network. From there you can start <code>python3</code>, install OWSLib and
maybe even other tools like <code>curl</code> and <code>wget</code>.</p>
<p>Below is a complete example, assuming pygeoapi runs on your <code>localhost</code> at port 5000:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="setup-__tabbed_6_1" name="setup-__tabbed_6" type="radio" /><input id="setup-__tabbed_6_2" name="setup-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="setup-__tabbed_6_1">Linux/Mac</label><label for="setup-__tabbed_6_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;python:3.10-slim&#39;</span><span class="w"> </span>locally
<span class="m">3</span>.10-slim:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/python
5b5fe70539cd:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
f4b0e4004dc0:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
c5424f0ac885:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
9d21fe1624ec:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
de0194aa1c21:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
Digest:<span class="w"> </span>sha256:7dc5b4e948acd18c1633b0e593ad0224298646612ce7d0b5ac6d4e17616d7e4b
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>python:3.10-slim

root@docker-desktop:/#<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>owslib
root@docker-desktop:/#<span class="w"> </span>python3
&gt;&gt;&gt;<span class="w"> </span>from<span class="w"> </span>owslib.ogcapi.features<span class="w"> </span>import<span class="w"> </span>Features
&gt;&gt;&gt;<span class="w"> </span><span class="nv">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Features<span class="o">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span>w
&lt;owslib.ogcapi.features.Features<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x7ff493e6f850&gt;
&gt;&gt;&gt;<span class="w"> </span><span class="nv">conformance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>w.conformance<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span>conformance
etc
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;python:3.10-slim&#39;</span><span class="w"> </span>locally
<span class="m">3</span>.10-slim:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/python
5b5fe70539cd:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
f4b0e4004dc0:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
c5424f0ac885:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
9d21fe1624ec:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
de0194aa1c21:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
Digest:<span class="w"> </span>sha256:7dc5b4e948acd18c1633b0e593ad0224298646612ce7d0b5ac6d4e17616d7e4b
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>python:3.10-slim

root@docker-desktop:/#<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>owslib
root@docker-desktop:/#<span class="w"> </span>python3
&gt;&gt;&gt;<span class="w"> </span>from<span class="w"> </span>owslib.ogcapi.features<span class="w"> </span>import<span class="w"> </span>Features
&gt;&gt;&gt;<span class="w"> </span><span class="nv">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Features<span class="o">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span>w
&lt;owslib.ogcapi.features.Features<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x7ff493e6f850&gt;
&gt;&gt;&gt;<span class="w"> </span><span class="nv">conformance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>w.conformance<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span>conformance
etc
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>We will refer to this installation in some of the Exercises where OWSLib is used.</p>
<div class="footnote">
<hr />
<ol>
<li id="setup-fn:2">
<p>For recent version of Docker run <code>docker compose version</code>&#160;<a class="footnote-backref" href="#setup-fnref:2" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="setup-fn:1">
<p>Alternatively, you can fork/clone the GitHub repository of this workshop directly from <a href="https://github.com/geopython/diving-into-pygeoapi">https://github.com/geopython/diving-into-pygeoapi</a>.&#160;<a class="footnote-backref" href="#setup-fnref:1" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="standards" heading-number="4"><h1 id="standards-overview">Overview</h1>
<p>This section provides a high level overview of standards support in pygeoapi.</p>
<h1 id="standards-standards">Standards</h1>
<p>Open standards are core to pygeoapi, and allow for broad interoperability and plug and play capability. pygeoapi supports
a number of open standards (both formal standards and defacto or community driven).</p>
<h2 id="standards-api-standards">API standards</h2>
<h3 id="standards-ogc-api">OGC API</h3>
<p>pygeoapi implements the <a href="https://ogcapi.ogc.org">OGC API</a> suite of standards from the <a href="https://www.ogc.org/">Open Geospatial Consortium</a> (OGC). From the OGC API website:</p>
<div class="admonition citation">
<p class="admonition-title">Citation</p>
<p>The OGC API family of standards are being developed to make it easy for anyone to provide geospatial data to the web. These standards build upon the legacy of the OGC Web Service standards (WMS, WFS, WCS, WPS, etc.), but define resource-centric APIs that take advantage of modern web development practices. This web page provides information on these standards in a consolidated location.</p>
<p>These standards are being constructed as "building blocks" that can be used to assemble novel APIs for web access to geospatial content. The building blocks are defined not only by the requirements of the specific standards, but also through interoperability prototyping and testing in OGC's Innovation Program. </p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can learn more about OGC APIs in the <a href="https://ogcapi-workshop.ogc.org">OGC API workshop</a></p>
</div>
<h4 id="standards-ogc-api-common">OGC API - Common</h4>
<p><a href="https://ogcapi.ogc.org/common/">OGC API - Common</a> is a common framework used in all OGC API's. 
OGC API - Common provides the following functionality:</p>
<ul>
<li>based on <a href="https://spec.openapis.org/oas/latest.html">OpenAPI 3.0</a></li>
<li>HTML and JSON as the dominant encodings, alternative encodings are possible</li>
<li>shared endpoints such as:<ul>
<li><code>/</code> (landing page)</li>
<li><code>/conformance</code></li>
<li><code>/openapi</code></li>
<li><code>/collections</code></li>
<li><code>/collections/foo</code></li>
</ul>
</li>
<li>aspects such as pagination, links between resources, basic filtering, query parameters (<code>bbox</code>, <code>datetime</code>, etc.)</li>
<li>shared models (exceptions, links, etc.)</li>
</ul>
<p>OGC API - Common allows for specification developers to focus on the key functionality of a given API (i.e. data access, etc.)
while using common constructs. This harmonizes OGC API standards and enables deeper integration with less code. This also
allows for OGC API client software to be more streamlined.</p>
<p>The <code>/conformance</code> endpoint indicates which standards and extensions are supported by a deployment of OGC API.</p>
<h4 id="standards-ogc-api-building-blocks">OGC API building blocks</h4>
<p>The OGC API approach allows for modularity and "profiling" of APIs depending on your requirements.  This means you
can mix and match OGC APIs together.</p>
<p><img alt="OGC API building blocks" src="../assets/images/ogc-api-building-blocks.png" /></p>
<p>You can read more about this topic in the <a href="https://blocks.ogc.org/">building blocks website</a>.</p>
<h4 id="standards-more-ogc-apis">More OGC APIs</h4>
<p>The OGC API effort is rapidly evolving. Numerous OGC API standards are in development, and will be implemented in
pygeoapi over time:</p>
<ul>
<li><a href="https://ogcapi.ogc.org/routes">Routes</a> provides access to routing data</li>
<li><a href="https://ogcapi.ogc.org/styles">Styles</a> defines a Web API that enables map servers, clients as well as visual style editors, to manage and fetch styles</li>
<li><a href="https://ogcapi.ogc.org/geovolumes">3D GeoVolumes</a> facilitates efficient discovery of and access to 3D content in multiple formats based on a space-centric perspective</li>
<li><a href="https://ogcapi.ogc.org/movingfeatures">Moving Features</a> defines an API that provides access to data representing features that move as rigid bodies</li>
<li><a href="https://ogcapi.ogc.org/joins">Joins</a>  supports the joining of data, from multiple sources, with feature collections or directly with other input files</li>
<li><a href="https://ogcapi.ogc.org/dggs">Discrete Global Grid System</a> enables applications to organise and access data arranged according to a Discrete Global Grid System (DGGS)</li>
</ul>
<p><img alt="Approved and candidate OGC API standards" src="../assets/images/ogcapis.png" /></p>
<h4 id="standards-ogc-apis-supported-by-pygeoapi">OGC APIs supported by pygeoapi</h4>
<p>pygeoapi implements numerous OGC API standards and draft standards. In addition, it is compliance certified and even a Reference Implementation (RI) for some of them. Compliance certification is important to remove interoperability risks. RI are always compliance certified. From OGC <a href="https://docs.ogc.org/pol/08-134r11.html#toc26">Compliance Testing Program Policies &amp; Procedures 08-134r11</a>:</p>
<div class="admonition citation">
<p class="admonition-title">Citation</p>
<p>Candidate Products that pass all the tests in a Compliance Test Package, and that OGC has reviewed and certified as having passed those tests, are considered compliant with that Implementation Standard version. </p>
</div>
<div class="admonition citation">
<p class="admonition-title">Citation</p>
<p>A Reference Implementation is a fully functional, licensed copy of a tested, branded software that has passes the test for an associated conformance class in a version of an Implementation Standard and that is free and publicly available for testing via a web service or download.</p>
</div>
<table>
<thead>
<tr>
<th>Standard</th>
<th>pygeoapi status</th>
<th>Included in this workshop</th>
</tr>
</thead>
<tbody>
<tr>
<td>OGC API - Features</td>
<td>Reference</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Coverages</td>
<td>Implementing</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Tiles</td>
<td>Reference</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Maps</td>
<td>Implementing</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Processes</td>
<td>Certified</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Records</td>
<td>Implementing</td>
<td>✅</td>
</tr>
<tr>
<td>OGC API - Environmental Data Retrieval</td>
<td>Reference</td>
<td>✅</td>
</tr>
<tr>
<td>SpatioTemporal Asset Catalog</td>
<td>Implementing</td>
<td></td>
</tr>
<tr>
<td>OGC API - Routes</td>
<td>Planned</td>
<td></td>
</tr>
<tr>
<td>OGC API - Styles</td>
<td>Planned</td>
<td></td>
</tr>
<tr>
<td>OGC API - Moving Features</td>
<td>Planned</td>
<td></td>
</tr>
<tr>
<td>OGC API - DGGS</td>
<td>Planned</td>
<td></td>
</tr>
</tbody>
</table>
<p>In the next section we will dive into the dedicated API's related to specific types of information. You will
notice that all APIs are combined and available via a single OGC API endpoint, thanks to OGC API - Common.</p>
<h4 id="standards-openapi">OpenAPI</h4>
<p>Core to OGC API - Common is the <a href="https://www.openapis.org/about">OpenAPI initiative</a> to help
describe and document an API. OpenAPI defines its structure in an OpenAPI document. 
OGC API - Common suggests this document to be located at <code>/openapi</code>. With pygeoapi in a browser 
<a href="https://demo.pygeoapi.io/master/openapi">this URL</a> opens an interactive HTML page which facilitates 
an API query. Append <code>?f=json</code> to view the document in JSON. The OpenAPI document indicates which
endpoints are available in the service, which parameters it accepts and 
what types of responses can be expected. The OpenAPI document is a similar concept to Capabilities
XML as part of the first genration OGC Web Service standards.</p>
<div class="admonition question">
<p class="admonition-title">OpenAPI Specification parsing in a browser</p>
<p>A common approach to interact with Open API's using json is to use a program like 
<a href="https://www.postman.com/">Postman</a>. Also there are browser plugins which enable to define api 
requests interactively within a browser. For firefox download the plugin 
<a href="https://pluginsaddonsextensions.com/mozilla-firefox/poster-mozilla-addon">poster</a>. For Chrome 
and Edge use <a href="https://microsoftedge.microsoft.com/addons/detail/boomerang-soap-rest-c/bhmdjpobkcdcompmlhiigoidknlgghfo?hl=en-US">Boomerang</a>. 
In Boomerang you can create individual web requests, but also load the open api specification 
document and interact with any of the advertised endpoints. </p>
</div>
<p>The OpenAPI community provides various tools, such as a validator for OAS documents or 
<a href="https://swagger.io/tools/swagger-codegen/">generate code</a> as a starting point for client development.</p>
<h2 id="standards-content-and-format-standards">Content and format standards</h2>
<p>JSON is core in pygeoapi, providing a format that is machine readable and easy to parse and handle
by client software and tools.  OGC API - Common provides uniform JSON formats for the various
endpoints it supports.  Specific OGC API standards may specify domain specific formats (for example,
GeoJSON for OGC API - Features, GeoTIFF for OGC API - Coverages) depending on the data type(s).</p>
<h1 id="standards-pygeoapi-specific-conventions">pygeoapi specific conventions</h1>
<p>pygeoapi provides some conventions that are not put forth by OGC API standards, however facilitate
some features and capabilities.</p>
<h2 id="standards-the-f-parameter">the <code>f</code> parameter</h2>
<p>The <code>f</code> parameter can be used with any pygeoapi endpoint to specify an output format for a given
  API request.  Examples are <code>f=html</code>, <code>f=json</code>, etc.</p>
<div class="admonition question">
<p class="admonition-title">Using a web browser to access OGC API</p>
<p>Use your web browser to navigate to <a href="https://demo.pygeoapi.io/master">demo.pygeoapi.io</a>. A browser by default opens 
any OGC API in HTML (as a webpage) due to the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept">HTTP Accept header</a> 
sent by the browser (<code>text/html</code>). On the right top corner you will notice a JSON link. The link 
adds the parameter to the url: <code>f=json</code>, which is a mechanism of pygeoapi to override the HTTP Accept
header sent by the web browser.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When calling an OGC API from javascript, and the aim is to receive JSON, you can use the <code>?f=json</code> pygeoapi convention, or the content 
negotiation as provided by the standard; include an HTTP header <code>Accept: "application/json"</code> in your request.</p>
<p>In jQuery for example, this is represented by the dataType property:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://demo.pygeoapi.io/master&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;json&quot;</span>
<span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Or using the native fetch API:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;Accept&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div></td></tr></table></div>
</div>
<h2 id="standards-the-skipgeometry-parameter">the <code>skipGeometry</code> parameter</h2>
<p>The <code>skipGeometry</code> (<code>true|false</code>, default is <code>false</code>) parameter can be used with feature data access to facilitate
downloading vector data without geometry if desired.</p>
<h1 id="standards-summary">Summary</h1>
<p>Standards are a cornerstone of pygeoapi, and will enable you to publish your data efficiently and with a low
barrier for users.  Now, let's get to the action: <strong>Publishing data</strong>!</p></section>
                    <section class='print-page md-section' id='section-5' heading-number='5'>
                        <h1>Publishing<a class='headerlink' href='#section-5' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="publishing" heading-number="5.1"><h1 id="publishing-publishing-data">Publishing Data</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure that you have pygeoapi setup and can navigate the default configuration and service running at <a href="http://localhost:5000">http://localhost:5000</a>.</p>
</div>
<p>In this section, you will learn how to publish different types of geospatial data and metadata
through the following exercises:</p>
<ul>
<li><a href="#publishing-first">Exercise 1 - Your first dataset</a></li>
<li><a href="#publishing-ogcapi-features">Exercise 2 - Vector data via OGC API - Features</a></li>
<li><a href="#publishing-ogcapi-coverages">Exercise 3 - Raster data via OGC API - Coverages</a></li>
<li><a href="#publishing-ogcapi-maps">Exercise 4 - Maps of geospatial data via OGC API - Maps</a></li>
<li><a href="#publishing-ogcapi-tiles">Exercise 5 - Tiles of geospatial data via OGC API - Tiles</a></li>
<li><a href="#publishing-ogcapi-records">Exercise 6 - Metadata via OGC API - Records</a></li>
<li><a href="#publishing-ogcapi-edr">Exercise 7 - Environmental data via OGC API - Environmental Data Retrieval</a></li>
<li><a href="#publishing-ogcapi-processes">Exercise 8 - Functions via OGC API - Processes</a></li>
<li><a href="#advanced-bridges">Exercise 9 - pygeoapi as a bridge to other services</a></li>
</ul></section><section class="print-page" id="publishing-first" heading-number="5.2"><h1 id="publishing-first-exercise-1-your-first-dataset">Exercise 1 - Your first dataset</h1>
<p>In this section you are going to publish a vector dataset.</p>
<p>For this exercise, we will use a CSV dataset of <a href="https://github.com/geopython/diving-into-pygeoapi/tree/main/workshop/exercises/data/tartu/bathingwater-estonia.csv">Bathing waters in Estonia</a>,
kindly provided by <a href="https://terviseamet.ee">Estonian Health Board</a>.</p>
<p>You can find this dataset in <code>workshop/exercises/data/tartu/bathingwater-estonia.csv</code>.</p>
<p>This exercise consists of adjusting <code>workshop/exercises/pygeoapi.config.yml</code> to define this dataset as an OGC API - Features <em>collection</em></p>
<h2 id="publishing-first-verify-the-existing-docker-compose-config">Verify the existing Docker Compose config</h2>
<p>Before making any changes, we will make sure that the initial Docker Compose
setup provided to you is actually working.</p>
<p>To test:</p>
<div class="admonition question">
<p class="admonition-title">Test the workshop configuration</p>
<ol>
<li>In a terminal shell navigate to the workshop folder and type:</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-first-__tabbed_1_1" name="publishing-first-__tabbed_1" type="radio" /><input id="publishing-first-__tabbed_1_2" name="publishing-first-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-first-__tabbed_1_1">Linux/Mac</label><label for="publishing-first-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
</div>
</div>
<ol>
<li>Open <a href="http://localhost:5000">http://localhost:5000</a> in your browser, verify some collections</li>
<li>Close by typing <code>CTRL-C</code></li>
</ol>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may also run the Docker container in the background (detached) as follows:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-first-__tabbed_2_1" name="publishing-first-__tabbed_2" type="radio" /><input id="publishing-first-__tabbed_2_2" name="publishing-first-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-first-__tabbed_2_1">Linux/Mac</label><label for="publishing-first-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
docker<span class="w"> </span>ps<span class="w">  </span><span class="c1"># verify that the pygeoapi container is running</span>
<span class="c1"># visit http://localhost:5000 in your browser, verify some collections</span>
docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi<span class="w">  </span><span class="c1"># view logs</span>
docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>--remove-orphans
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
docker<span class="w"> </span>ps<span class="w">  </span><span class="c1"># verify that the pygeoapi container is running</span>
<span class="c1"># visit http://localhost:5000 in your browser, verify some collections</span>
docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi<span class="w">  </span><span class="c1"># view logs</span>
docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>--remove-orphans
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h2 id="publishing-first-publish-first-dataset">Publish first dataset</h2>
<p>You are now ready to publish your first dataset.</p>
<div class="admonition question">
<p class="admonition-title">Setting up the pygeoapi config file</p>
<ol>
<li>Open the file <code>workshop/exercises/pygeoapi/pygeoapi.config.yml</code> in your text editor</li>
<li>Look for the commented config section starting with <code># START - EXERCISE 1 - Your First Collection</code></li>
<li>Uncomment all lines until <code># END - EXERCISE 1 - Your First Collection</code></li>
</ol>
</div>
<p>Make sure that the indentation aligns (hint: directly under <code># START ...</code>)</p>
<p>The config section reads:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code>    Bathing_Water_Estonia:
        type: collection
        title: Bathing Water Estonia
        description: Locations where the Estonian Health Board monitors the bathing water quality
        keywords:
            - bathing water
            - estonia
        links:
            - type: text/csv
              rel: canonical
              title: data
              href: https://avaandmed.eesti.ee/datasets/supluskohad
              hreflang: EE
        extents:
            spatial:
                bbox: [20,57,29,60]
                crs: http://www.opengis.net/def/crs/EPSG/0/4326
        providers:
            - type: feature
              name: CSV
              data: /data/tartu/bathingwater-estonia.csv
              id_field: id
              title_field: Name
              geometry:
                x_field: x
                y_field: y
              storage_crs: http://www.opengis.net/def/crs/EPSG/0/3300
</code></pre></div></td></tr></table></div>
<p>The most relevant part is the <code>providers</code> section. Here, we define a <code>CSV Provider</code>,
pointing the file path to the <code>/data</code> directory we will mount (see next) from the local
directory into the Docker container above. Because a CSV is not a spatial file, we explicitly
configure pygeoapi so that the longitude and latitude (x and y) is mapped from the columns <code>lon</code>
and <code>lat</code> in the CSV file. Notice the <code>storage_crs</code> parameter, which indicates the coordinate system which is used in the source data.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To learn more about the pygeoapi configuration syntax and conventions see
the <a href="https://docs.pygeoapi.io/en/latest/configuration.html">relevant chapter in the documentation</a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>pygeoapi includes <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#providers">numerous data providers</a> which
enable access to a variety of data formats. Via the OGR/GDAL plugin the number of supported formats is almost limitless.
Consult the <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#providers">data provider page</a> how you can set up
a connection to your dataset of choice. You can always copy a relevant example configuration and place it in the datasets section of
the pygeoapi configuration file for your future project.</p>
</div>
<h2 id="publishing-first-test">Test</h2>
<div class="admonition question">
<p class="admonition-title">Start with updated configuration</p>
<ol>
<li>Start by typing <code>docker compose up</code> </li>
<li>Observe logging output</li>
<li>If no errors: open <a href="http://localhost:5000">http://localhost:5000</a></li>
<li>Look for the Point of interest collection</li>
<li>Browse through the items of the collection</li>
<li>Check the json representation by adding ?f=json to url (or click 'json' in top right)</li>
</ol>
</div>
<h2 id="publishing-first-debugging-configuration-errors">Debugging configuration errors</h2>
<p>Incidentally you may run into errors, briefly discussed here:</p>
<ul>
<li>A file cannot be found, a typo in the configuration</li>
<li>The format or structure of the spatial file is not fully supported</li>
<li>The port (5000) is already taken. Is a previous pygeoapi still running? If you change the port, consider that you also have to update the pygeoapi config file</li>
</ul>
<p>There are two parameters in the configuration file which help to address these issues. 
Set the logging level to <code>DEBUG</code> and indicate a path to a log file. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>On Docker, set the path of the logfile to the mounted folder, so you can easily access it from your host system. You can also view the console logs from
your Docker container as follows:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="publishing-first-__tabbed_3_1" name="publishing-first-__tabbed_3" type="radio" /><input id="publishing-first-__tabbed_3_2" name="publishing-first-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="publishing-first-__tabbed_3_1">Linux/Mac</label><label for="publishing-first-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>--follow<span class="w"> </span>pygeoapi
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Errors related to file paths typically happen on initial setup. However, they may also happen at unexpected moments, resulting in a broken service.
Products such as <a href="https://geohealthcheck.org">GeoHealthCheck</a> aim to monitor, detect and notify service health and availability. The OGC API - Features
tests in GeoHealthCheck poll the availability of the service at intervals. Consult the <a href="https://docs.geohealthcheck.org">GeoHealthCheck documentation</a> for more
information. </p>
</div></section><section class="print-page" id="publishing-ogcapi-features" heading-number="5.3"><h1 id="publishing-ogcapi-features-exercise-2-vector-data-via-ogc-api-features">Exercise 2 - Vector data via OGC API - Features</h1>
<p><a href="https://ogcapi.ogc.org/features">OGC API - Features</a> provides a Web API to access vector 
data (geometries and their attributes). While the core specification covers basic data access and query,
additional related standards and extensions are in development for the following capabilities:</p>
<ul>
<li><a href="https://docs.ogc.org/is/17-069r4/17-069r4.html">OGC API - Features - Part 1: Core</a> provides basic access and query capabilities</li>
<li><a href="https://docs.ogc.org/is/18-058r1/18-058r1.html">OGC API - Features - Part 2: Coordinate Reference Systems by Reference</a> enables the import and export of any data according to dedicated projections</li>
<li><a href="https://docs.ogc.org/is/19-079r2/19-079r2.html">OGC API - Features - Part 3: Filtering</a> adds the ability for complex queries using <a href="https://docs.ogc.org/is/21-065r2/21-065r2.html">Common Query Language (CQL2)</a></li>
<li><a href="https://docs.ogc.org/DRAFTS/20-002r1.html">OGC API - Features - Part 4: Create, Replace, Update and Delete</a> (<strong>draft</strong>) adds transactional capabilities </li>
</ul>
<h2 id="publishing-ogcapi-features-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports all of the above OGC API - Features specification parts (Part 3 is dependent on backend support i.e. Elasticsearch).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html">the official documentation</a> for more information on supported vector backends</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/cql.html">the official documentation</a> for more information on CQL support </p>
</div>
<p>Next, we are going to explore how-to publish vector data using a <code>GeoPackage</code>.</p>
<h2 id="publishing-ogcapi-features-publish-a-geopackage">Publish a GeoPackage</h2>
<p>In the previous section we demonstrated the steps involved to add a dataset to pygeoapi and update the configuration. 
In this exercise we are going to publish another vector file, this time from a <a href="https://www.geopackage.org">GeoPackage</a> (SQLite3) 
vector data source.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It may be helpful to open the dataset in <a href="https://qgis.org">QGIS</a> while adding and updating your pygeoapi server to easily evaluate table attributes, names, spatial properties and CRS.</p>
</div>
<p>Let's add the file <code>workshop/exercises/data/brazil/guama_river.gpkg.zip</code>:</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>First, let's unzip the file <a href="https://github.com/geopython/diving-into-pygeoapi/tree/main/workshop/exercises/data/brazil/guama_river.gpkg.zip">guama_river.gpkg.zip</a> to <code>guama_river.gpkg</code>.</p>
<p>Then, open the pygeoapi configuration file in a text editor.
Find the line <code># START - EXERCISE 2 - flowlines Guama River</code>.</p>
<p>Add a new dataset section by uncommenting the lines up to <code># END - EXERCISE 2 - flowlines Guama River</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">guama-river</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Guama River</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Guama River Basin mainstem flowlines</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Guama River</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Merit Hydro</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.sciencebase.gov/catalog/item/614a8864d34e0df5fb97572d</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EE</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-49.16</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-5.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-46.8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-1.2</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SQLiteGPKG</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/brazil/guama_river.gpkg</span><span class="w"> </span><span class="c1"># place correct path here</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fid</span>
<span class="w">          </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guama_river</span><span class="w"> </span><span class="c1"># table name within gpkg</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Save the file and restart Docker Compose. Navigate to <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> to evaluate whether the new dataset with
title <em>"Guama River"</em> has been published.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SQLite driver incidentally has challenges to open the GeoPackage extension on MacOS. 
Consult the <a href="https://docs.pygeoapi.io/en/latest/development.html#working-with-spatialite-on-osx">official documentation</a> 
or try with an alternative data format. If you use Docker this is not an issue.</p>
</div>
<h2 id="publishing-ogcapi-features-optional-publish-a-geojson-file-using-elasticsearch">OPTIONAL: Publish a GeoJSON file using Elasticsearch</h2>
<p>This exercise is optional, if time permits, or you can perform this after workshop.</p>
<p>Here we explore publishing OGC API - Features data using pygeoapi with an Elasticsearch backend provider. 
For this we need the <a href="https://github.com/geopython/pygeoapi-examples">pygeoapi-examples GitHub repository</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_1_1" name="publishing-ogcapi-features-__tabbed_1" type="radio" /><input id="publishing-ogcapi-features-__tabbed_1_2" name="publishing-ogcapi-features-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_1_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Alternatively, you can <a href="https://github.com/geopython/pygeoapi-examples/archive/refs/heads/main.zip">download the repo as a .zip file</a> and unzip.</p>
<p>Change into the <code>docker/elastic</code> folder and run the <code>docker-compose.yml</code> file:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_2_1" name="publishing-ogcapi-features-__tabbed_2" type="radio" /><input id="publishing-ogcapi-features-__tabbed_2_2" name="publishing-ogcapi-features-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_2_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/elastic
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/elastic
docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>If you experience startup problems, consult the <a href="https://github.com/geopython/pygeoapi-examples/blob/main/docker/elastic/README.md">README file</a>. 
You may need to adapt your local host system's virtual memory setting.</p>
<p>First we will load <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> into the Elasticsearch server. </p>
<p>Edit the <code>add-data.sh</code> script within the <code>ES</code> folder, adding these two lines before the end:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-o<span class="w"> </span>/tmp/hyderabad.geojson<span class="w"> </span>https://raw.githubusercontent.com/geopython/diving-into-pygeoapi/refs/heads/main/workshop/exercises/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson
python3<span class="w"> </span>/load_es_data.py<span class="w"> </span>/tmp/hyderabad.geojson<span class="w"> </span>objectid
</code></pre></div></td></tr></table></div>
Through these changes the file <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> is downloaded inside the Elasticsearch Docker container and then loaded into Elasticsearch. </p>
<p>After this we need to rebuild the Docker image:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_3_1" name="publishing-ogcapi-features-__tabbed_3" type="radio" /><input id="publishing-ogcapi-features-__tabbed_3_2" name="publishing-ogcapi-features-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_3_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Next we need to configure pygeoapi by inserting the snippet below into the pygeoapi config file <code>pygeoapi/docker.config.yml</code>.
This effectively enables publishing the file <code>greater_hyderabad_municipal_corporation_ward_boundaries.geojson</code> as OGC API - Features
using the Elasticsearch backend provider.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">hyderabad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Greater Hyderabad Municipal Corporation ward boundaries</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The city ward boundaries represent the administrative and electoral boundary areas of the city. It plays a great role in planning of the city, for each council of the municipal corporation.</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Boundaries</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ward</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">78.2379194985166180</span><span class="p p-Indicator">,</span><span class="nv">17.2908061510471995</span><span class="p p-Indicator">,</span><span class="nv">78.6217049083810764</span><span class="p p-Indicator">,</span><span class="nv">17.5618443356918768</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2011-11-11</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Elasticsearch</span>
<span class="w">              </span><span class="c1">#Note elastic_search is the docker container of ES the name is defined in the docker-compose.yml</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://elastic_search:9200/hyderabad</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">objectid</span>
</code></pre></div></td></tr></table></div>
<p>On startup (e.g.: docker compose up -d) the pygeaoapi container will wait until the data has been ingested and the Elasticsearch index has been built. 
You can check the logs using:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_4_1" name="publishing-ogcapi-features-__tabbed_4" type="radio" /><input id="publishing-ogcapi-features-__tabbed_4_2" name="publishing-ogcapi-features-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_4_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>--follow
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>--follow
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>After the server has started you can access the collection page here:</p>
<p><a href="http://localhost:5000/collections/hyderabad">http://localhost:5000/collections/hyderabad</a></p>
<p>And the feature items here:</p>
<p><a href="http://localhost:5000/collections/hyderabad/items">http://localhost:5000/collections/hyderabad/items</a></p>
<p><img alt="" src="../assets/images/features-hyderabad.png" width="100%" /></p>
<h2 id="publishing-ogcapi-features-optional-pygeoapi-as-a-wfs-proxy">OPTIONAL: pygeoapi as a WFS proxy</h2>
<p>pygeoapi can also function as an OGC API - Features frontend service for an existing OGC WFS through 
the built-in GDAL/OGR provider. This bridging-function effectively allows you to publish a WFS as OGC API - Features.</p>
<p>This is expanded in an advanced section of this workshop: <a href="#advanced-bridges-publishing-wfs-as-ogc-api-features">pygeoapi as a Bridge to other Services WFS-section</a>. </p>
<h2 id="publishing-ogcapi-features-client-access">Client access</h2>
<h3 id="publishing-ogcapi-features-qgis">QGIS</h3>
<p>QGIS is one of the first GIS Desktop clients which added support for OGC API - Features. Support has been integrated into the existing WFS provider.</p>
<div class="admonition question">
<p class="admonition-title">Open an OGC API - Features collection in QGIS</p>
<p>Follow the steps to add some collections from an OGC API - Features enpoint: </p>
<ul>
<li>Open QGIS (if you don't have QGIS, you can use OSGeoLive)</li>
<li>From the Layer menu, select <code>Add Layer</code> &gt; <code>Add WFS layer</code></li>
<li>From the <code>Data source manager</code> panel, choose 'New connection'</li>
</ul>
<p><img alt="New connection" src="../assets/images/new-connection.png" width="50%" /></p>
<ul>
<li>Add the URL https://demo.pygeoapi.io/master (or the address of a local server)</li>
<li>You can now click the <code>detect</code> button and QGIS will notice you are configuring an OGC API - Features endpoint</li>
<li>QGIS facilitates to set page size (request is split in multiple requests)<ul>
<li>for points you can easily set it to 2500</li>
<li>for some polygons with high density, 100 can already be slow</li>
</ul>
</li>
<li>Press <code>OK</code> to save the connection and return to the previous screen</li>
<li>Now click the <code>Connect</code> button to retireve the collections of the service</li>
</ul>
<p><img alt="Collection list" src="../assets/images/collection-list.png" width="50%" /></p>
<ul>
<li>You can now add collections to your QGIS project</li>
<li>You can also build a query to add a subset of the collection</li>
<li>Close the <code>Data source manager</code>. Notice that QGIS applied a default styling just like it would if you add a file based layer. You can work with the collection in a similar way; identify, apply styling, filter, export, etc.</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Activate the <code>Debugging/Development Tools Panel</code> (right click anywhere on the toolbar icons and select). It will display HTTP traffic within QGIS and is a valuable tool in debugging failing connections.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An increasing number of GIS Desktop clients add support for OGC API's in subsequent releases. For example ArcGIS Pro <a href="https://pro.arcgis.com/en/pro-app/2.8/help/data/services/use-ogc-api-services.htm">supports OGC API - Features</a> since release 2.8.</p>
</div>
<h3 id="publishing-ogcapi-features-gdalogr-advanced">GDAL/OGR - Advanced</h3>
<p><a href="https://gdal.org">GDAL/OGR</a> provides support for <a href="https://gdal.org/drivers/vector/oapif.html">OGC API - Features</a>. This means you can use <code>ogrinfo</code>, <code>ogr2ogr</code> to query and convert data from OGC API - Features endpoints just like any other vector data source.  This also means you can make connections to OGC API - Features endpoints from any software which has an interface to GDAL, such as MapServer, GeoServer, Manifold, FME, ArcGIS, etc.</p>
<div class="admonition question">
<p class="admonition-title">Use OGR to interact with OGC API - Features</p>
<ul>
<li>Verify you have a recent GDAL installed, else use GDAL from OSGeoLive</li>
<li>Run <code>ogrinfo</code> on the command line to verify a connection to OGC API - Features</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="publishing-ogcapi-features-__tabbed_5_1" name="publishing-ogcapi-features-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_5_1">Linux/Mac</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><div class="termy">
    <div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
    </div></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="publishing-ogcapi-features-__tabbed_6_1" name="publishing-ogcapi-features-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_6_1">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Check summary information about the layer with:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_7_1" name="publishing-ogcapi-features-__tabbed_7" type="radio" /><input id="publishing-ogcapi-features-__tabbed_7_2" name="publishing-ogcapi-features-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_7_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_7_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogrinfo<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Now, let's convert the observations into a shapefile</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_8_1" name="publishing-ogcapi-features-__tabbed_8" type="radio" /><input id="publishing-ogcapi-features-__tabbed_8_2" name="publishing-ogcapi-features-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_8_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_8_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogr2ogr<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="w"> </span>obs.shp<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>ogr2ogr<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;ESRI Shapefile&quot;</span><span class="w"> </span>obs.shp<span class="w"> </span>OAPIF:https://demo.pygeoapi.io/master/collections/obs
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can even use OGR to append new features to an OGC API - Features collection which supports transactions. Read more <a href="https://docs.pygeoapi.io/en/latest/transactions.html">here</a> about support for transactions in pygeoapi.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Use GDAL from the commandline with Docker</p>
<p>If you do not have GDAL installed, or want to use/try another version, you can always run the GDAL Docker image
directly from the commandline. OSGeo provides <a href="https://github.com/OSGeo/gdal/pkgs/container/gdal">GDAL Docker Images</a>. The main thing to deal with is proper Docker Volume mapping to have GDAL tools 
access local files. This can be very handy for quick data conversions. Most images also come with GDAL Python bindings.</p>
<p>First you can pull a very small Docker Image:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_9_1" name="publishing-ogcapi-features-__tabbed_9" type="radio" /><input id="publishing-ogcapi-features-__tabbed_9_2" name="publishing-ogcapi-features-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_9_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_9_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then you can run for example OGR command line tools. Base command is <code>docker run -it --rm ghcr.io/osgeo/gdal:alpine-small-latest</code>.
This runs the Docker container interactively (<code>-it</code>) and removes the container on exit (<code>--rm</code>).  Below are examples.</p>
<p>Ask GDAL/OGR for available Vector formats:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_10_1" name="publishing-ogcapi-features-__tabbed_10" type="radio" /><input id="publishing-ogcapi-features-__tabbed_10_2" name="publishing-ogcapi-features-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_10_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_10_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
<span class="w">                    </span>ogrinfo<span class="w"> </span>--formats
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span>ogrinfo<span class="w"> </span>--formats
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Get information from a geospatial file. Note the volume mapping: <code>-v $(pwd)/data:/work</code> 
to access local files within the Docker container (commands are single-line, broken up for readability).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_11_1" name="publishing-ogcapi-features-__tabbed_11" type="radio" /><input id="publishing-ogcapi-features-__tabbed_11_2" name="publishing-ogcapi-features-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_11_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_11_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>git/workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/work<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ogrinfo<span class="w"> </span>/work/tartu/bathingwater-estonia.geojson

INFO:<span class="w"> </span>Open<span class="w"> </span>of<span class="w"> </span><span class="sb">`</span>/work/tartu/bathingwater-estonia.geojson<span class="s1">&#39;</span>
<span class="s1">      using driver `GeoJSON&#39;</span><span class="w"> </span>successful.
<span class="m">1</span>:<span class="w"> </span>bathingwater-estonia<span class="w"> </span><span class="o">(</span>Point<span class="o">)</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>git/workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/work<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span>ogrinfo<span class="w"> </span>/work/tartu/bathingwater-estonia.geojson

INFO:<span class="w"> </span>Open<span class="w"> </span>of<span class="w"> </span><span class="sb">`</span>/work/tartu/bathingwater-estonia.geojson<span class="s1">&#39;</span>
<span class="s1">      using driver `GeoJSON&#39;</span><span class="w"> </span>successful.
<span class="m">1</span>:<span class="w"> </span>bathingwater-estonia<span class="w"> </span><span class="o">(</span>Point<span class="o">)</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Convert the GeoJSON file to a GeoPackage (GPKG) with <code>ogr2ogr</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_12_1" name="publishing-ogcapi-features-__tabbed_12" type="radio" /><input id="publishing-ogcapi-features-__tabbed_12_2" name="publishing-ogcapi-features-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_12_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_12_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/work<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>ogr2ogr<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;GPKG&quot;</span><span class="w"> </span>/work/tartu/bathingwater-estonia.gpkg<span class="w"> </span><span class="se">\</span>
<span class="w">                     </span>/work/tartu/bathingwater-estonia.geojson
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<code>bash
docker run -v ${pwd}/data:/work -it --rm ghcr.io/osgeo/gdal:alpine-small-latest ogr2ogr -f "GPKG" /work/tartu/bathingwater-estonia.gpkg /work/tartu/bathingwater-estonia.geojson</code>
</div></p>
</div>
</div>
</div>
<p>You can also use <code>ogrinfo</code> retrieve information about an OGC API - Features collection.  In case you are accessing a local collection, you will need to make sure the container runs on the host network:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_13_1" name="publishing-ogcapi-features-__tabbed_13" type="radio" /><input id="publishing-ogcapi-features-__tabbed_13_2" name="publishing-ogcapi-features-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_13_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_13_2">Windows</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
--network<span class="o">=</span>host<span class="w"> </span><span class="se">\</span>
ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span><span class="se">\</span>
ogrinfo<span class="w"> </span>OAPIF:http://localhost:5000/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>ghcr.io/osgeo/gdal:alpine-small-latest<span class="w"> </span>ogrinfo<span class="w"> </span>OAPIF:http://localhost:5000/collections/obs<span class="w"> </span>obs<span class="w"> </span>-so
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h3 id="publishing-ogcapi-features-owslib-advanced">OWSLib - Advanced</h3>
<p><a href="https://owslib.readthedocs.io">OWSLib</a> is a Python library to interact with OGC Web Services and supports a number of OGC APIs including OGC API - Features.</p>
<p>This exercise will be done using a jupyter notebook. If you prefer, you can do it using Python from the command line (see bellow).</p>
<p>Before continuing, make sure you are in the <code>workshop/exercises</code> folder. You will need that, to be able to use the jupyter notebook.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_14_1" name="publishing-ogcapi-features-__tabbed_14" type="radio" /><input id="publishing-ogcapi-features-__tabbed_14_2" name="publishing-ogcapi-features-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_14_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_14_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">pwd</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then run a container to start a jupyter notebook, mounting the local folder:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_15_1" name="publishing-ogcapi-features-__tabbed_15" type="radio" /><input id="publishing-ogcapi-features-__tabbed_15_2" name="publishing-ogcapi-features-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_15_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_15_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/home/jovyan/work<span class="w"> </span>jupyter/base-notebook
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>:/home/jovyan/work<span class="w"> </span>jupyter/base-notebook
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Enter the url stated on the command line,  <code>http://127.0.0.1:8888/lab</code> followed by a token. Enter the <code>work</code> folder and open the <code>features-owslib.ipynb</code>.</p>
<p><img alt="jupyter notebook" src="../assets/images/jupyter1.png" /></p>
<p>Run through the notebook, to explore an OGC API - Features server, using owslib.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can run the same instructions using your local pygeoapi server, instead of the demo pygeoapi instance.</p>
</div>
<h4 id="publishing-ogcapi-features-using-python-from-the-command-line">Using Python from the command line</h4>
<div class="admonition question">
<p class="admonition-title">Interact with OGC API - Features via OWSLib</p>
<p>If you do not have Python installed, consider running this exercise in a Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_16_1" name="publishing-ogcapi-features-__tabbed_16" type="radio" /><input id="publishing-ogcapi-features-__tabbed_16_2" name="publishing-ogcapi-features-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_16_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_16_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then start a Python console session with <code>python3</code> (stop the session by typing <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="publishing-ogcapi-features-__tabbed_17_1" name="publishing-ogcapi-features-__tabbed_17" type="radio" /><input id="publishing-ogcapi-features-__tabbed_17_2" name="publishing-ogcapi-features-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-features-__tabbed_17_1">Linux/Mac</label><label for="publishing-ogcapi-features-__tabbed_17_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">Features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Features</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">conformance</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">conformance</span><span class="p">()</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;conformsTo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/core&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/html&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson&#39;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># OpenAPI document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">feature_collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_collections</span><span class="p">)</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Large Lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes of the world, public domain&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_queryables</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_queryables</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lakes_queryables</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">])</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;scalerank&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name_alt&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;featureclass&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake Baikal&#39;</span><span class="p">}</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">Features</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Features</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">conformance</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">conformance</span><span class="p">()</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;conformsTo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/core&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/html&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson&#39;</span><span class="p">]}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># OpenAPI document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">feature_collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">feature_collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_collections</span><span class="p">)</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Large Lakes&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;lakes of the world, public domain&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_queryables</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_queryables</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lakes_queryables</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">])</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lakes_query</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>
<span class="p">{</span><span class="sa">u</span><span class="s1">&#39;scalerank&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name_alt&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;featureclass&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Lake Baikal&#39;</span><span class="p">}</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the official <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">OWSLib documentation</a> for more examples.</p>
</div>
<h1 id="publishing-ogcapi-features-summary">Summary</h1>
<p>Congratulations! You are now able to publish vector data with pygeoapi.</p></section><section class="print-page" id="publishing-ogcapi-coverages" heading-number="5.4"><h1 id="publishing-ogcapi-coverages-exercise-3-raster-data-via-ogc-api-coverages">Exercise 3 - Raster data via OGC API - Coverages</h1>
<p><a href="https://ogcapi.ogc.org/coverages">OGC API - Coverages</a> provides a Web API to access raster
data (grids, remote sensing data, multidimensional data cubes):</p>
<ul>
<li><a href="https://docs.ogc.org/DRAFTS/19-087.html">OGC API - Coverages</a> (<strong>draft</strong>)</li>
</ul>
<h2 id="publishing-ogcapi-coverages-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports the OGC API - Coverages draft specification, with <a href="https://rasterio.readthedocs.io">rasterio</a> and <a href="https://docs.xarray.dev">xarray</a> as core backends
as well as <a href="https://covjson.org">CoverageJSON</a> and native output.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-coverages.html">the official documentation</a> for more information on supported raster backends</p>
</div>
<h2 id="publishing-ogcapi-coverages-publish-a-raster-dataset">Publish a raster dataset</h2>
<p>In the previous exercises we have demonstrated the steps involved to publish vector data and update the pygeoapi configuration. In this section we are going to publish a raster file in GeoTIFF format, from a <a href="https://rasterio.readthedocs.io">rasterio</a> source provider.</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration file in a text editor. Add a new dataset section as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">tartu-ntl</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NASA Blue Marble Night Lights Data sample over Estonia</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NASA Blue Marble Night Lights Data sample over Estonia</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Blue Marble</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Night Lights</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NTL</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">about</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NASA Blue Marble Night Lights Data</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://appliedsciences.nasa.gov/get-involved/training/english/arset-introduction-nasas-black-marble-night-lights-data</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">          </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">26.6264</span><span class="p p-Indicator">,</span><span class="nv">58.32569</span><span class="p p-Indicator">,</span><span class="nv">26.82632</span><span class="p p-Indicator">,</span><span class="nv">58.433989</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">coverage</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rasterio</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/tartu/estonia_light.tif</span><span class="w"> </span><span class="c1"># place correct path here</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GTiff</span>
<span class="w">              </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/tiff</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The rasterio provider <code>format.name</code> directive <strong>requires</strong> a valid <a href="https://gdal.org/drivers/raster/index.html">GDAL raster driver short name</a></p>
</div>
<p>Save the configuration and restart Docker Compose. Navigate to <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> to evaluate whether the new dataset has been published.</p>
<h2 id="publishing-ogcapi-coverages-client-access">Client access</h2>
<h3 id="publishing-ogcapi-coverages-gdalogr">GDAL/OGR</h3>
<p><a href="https://gdal.org">GDAL/OGR</a> provides support for <a href="https://gdal.org/drivers/raster/ogcapi.html">OGC API - Coverages</a>. This means you can use <code>gdalinfo</code> to query and convert data from OGC API - Coverages endpoints just like any other raster data source.  This also means you can make connections to OGC API - Coverages endpoints from any software which has an interface to GDAL, such as MapServer, GeoServer, Manifold, FME, ArcGIS, etc.</p>
<div class="admonition question">
<p class="admonition-title">Use GDAL to interact with OGC API - Coverages</p>
<ul>
<li>Verify you have a recent GDAL installed, else use GDAL from OSGeoLive</li>
<li>Run <code>gdalinfo</code> on the command line to verify a connection to OGC API - Coverages:</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-ogcapi-coverages-__tabbed_1_1" name="publishing-ogcapi-coverages-__tabbed_1" type="radio" /><input id="publishing-ogcapi-coverages-__tabbed_1_2" name="publishing-ogcapi-coverages-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-coverages-__tabbed_1_1">Linux/Mac</label><label for="publishing-ogcapi-coverages-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>gdalinfo OGCAPI:https://maps.ecere.com/ogcapi/collections/SRTM_ViewFinderPanorama
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>gdalinfo OGCAPI:https://maps.ecere.com/ogcapi/collections/SRTM_ViewFinderPanorama
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h3 id="publishing-ogcapi-coverages-owslib">OWSLib</h3>
<p><a href="https://owslib.readthedocs.io">OWSLib</a> is a Python library to interact with OGC Web Services and supports a number of OGC APIs including OGC API - Coverages.</p>
<div class="admonition question">
<p class="admonition-title">Interact with OGC API - Coverages via OWSLib</p>
<p>If you do not have Python installed, consider running this exercise in a Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-ogcapi-coverages-__tabbed_2_1" name="publishing-ogcapi-coverages-__tabbed_2" type="radio" /><input id="publishing-ogcapi-coverages-__tabbed_2_2" name="publishing-ogcapi-coverages-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-coverages-__tabbed_2_1">Linux/Mac</label><label for="publishing-ogcapi-coverages-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then start a Python console session with: <code>python3</code> (stop the session by typing <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="publishing-ogcapi-coverages-__tabbed_3_1" name="publishing-ogcapi-coverages-__tabbed_3" type="radio" /><input id="publishing-ogcapi-coverages-__tabbed_3_2" name="publishing-ogcapi-coverages-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-coverages-__tabbed_3_1">Linux/Mac</label><label for="publishing-ogcapi-coverages-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.coverages</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coverages</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Coverages</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;gdps-temperature&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Global Deterministic Prediction System sample&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Global Deterministic Prediction System sample&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_schema</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">])</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Temperature [C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;x-ogc-unit&#39;</span><span class="p">]</span>
<span class="s1">&#39;[C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
<span class="s1">&#39;number&#39;</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.coverages</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coverages</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Coverages</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;gdps-temperature&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Global Deterministic Prediction System sample&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">gdps</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Global Deterministic Prediction System sample&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_schema</span><span class="p">(</span><span class="s1">&#39;gdps-temperature&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">])</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Temperature [C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;x-ogc-unit&#39;</span><span class="p">]</span>
<span class="s1">&#39;[C]&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
<span class="s1">&#39;number&#39;</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the official <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">OWSLib documentation</a> for more examples.</p>
</div>
<h1 id="publishing-ogcapi-coverages-summary">Summary</h1>
<p>Congratulations! You are now able to publish raster data to pygeoapi.</p></section><section class="print-page" id="publishing-ogcapi-maps" heading-number="5.5"><h1 id="publishing-ogcapi-maps-exercise-4-maps-of-geospatial-data-via-ogc-api-maps">Exercise 4 - Maps of geospatial data via OGC API - Maps</h1>
<p><a href="https://ogcapi.ogc.org/maps">OGC API - Maps</a> provides a Web API to access
any geospatial data as a georeferenced map image.</p>
<ul>
<li><a href="https://docs.ogc.org/DRAFTS/20-058.html">OGC API - Maps</a></li>
</ul>
<h2 id="publishing-ogcapi-maps-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports the OGC API - Maps specification, using <a href="https://www.mapserver.org/mapscript">MapServer MapScript</a> and a WMS facade as core backends.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-maps.html">the official documentation</a> for more information on supported map backends</p>
</div>
<h2 id="publishing-ogcapi-maps-publish-a-raster-dataset">Publish a raster dataset</h2>
<p>In this section we'll be exposing a Geopackage file available at <code>workshop/exercises/data/airport.gpkg</code> location using <a href="https://www.mapserver.org/mapscript">MapServer MapScript</a>. This data can be consumed with various clients which are compliant with OGC APIs - Maps. List of few such clients can be found <a href="https://github.com/opengeospatial/ogcapi-maps/blob/master/implementations.adoc#clients">here</a>. Here we can also pass style in <em>.sld</em> format. Which can be generated on <a href="https://docs.geoserver.org/stable/en/user/styling/index.html">Geoserver</a>, <a href="https://www.qgistutorials.com/en/docs/3/basic_vector_styling.html">QGIS</a>, etc. </p>
<div class="admonition question">
<p class="admonition-title">Interact with OGC API - Maps via MapScript</p>
<p>Open the pygeoapi configuration file in a text editor. Find the line <code># START - EXERCISE 4 - Maps</code>.</p>
<p>Uncomment section related to #airports.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">airports</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airports of the world</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Point data representing airports around the world with various metadata such as name, Code, etc.</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airports</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">natural earth</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://www.naturalearthdata.com/downloads/10m-cultural-vectors/airports/</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">        </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">            </span><span class="nt">begin</span><span class="p">:</span>
<span class="w">            </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MapScript</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/airport.gpkg</span>
<span class="w">          </span><span class="nt">options</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MS_LAYER_POINT</span>
<span class="w">              </span><span class="nt">layer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">airport</span>
<span class="w">              </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/airport.sld</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">png</span>
<span class="w">              </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image/png</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-maps.html">the official documentation</a> for more information on supported map backends</p>
</div>
<h2 id="publishing-ogcapi-maps-pygeoapi-as-a-wms-proxy">pygeoapi as a WMS proxy</h2>
<p>You can check the "pygeoapi as a Bridge to Other Services" section to learn how to <a href="#advanced-bridges-publishing-wms-as-ogc-api-maps">publish WMS as OGC API - Maps</a>.</p>
<h2 id="publishing-ogcapi-maps-client-access">Client access</h2>
<h3 id="publishing-ogcapi-maps-qgis">QGIS</h3>
<p>QGIS added support for API's providing rendered image layers via its raster support. </p>
<div class="admonition question">
<p class="admonition-title">Add OGC API - Maps layer to QGIS</p>
<ul>
<li>Install a recent version of QGIS (&gt;3.28). </li>
<li>Open the <code>Add raster layer panel</code>.</li>
<li>Select <code>OGCAPI</code> for Source type.</li>
<li>Add the local endpoint as source <code>http://localhost:5000/collections/airports</code>.</li>
<li>Select <code>PNG</code> as image format.</li>
<li>Finally add the layer to the map.</li>
</ul>
</div>
<h3 id="publishing-ogcapi-maps-owslib">OWSLib</h3>
<p><a href="https://owslib.readthedocs.io">OWSLib</a> is a Python library to interact with OGC Web Services and supports a number of OGC APIs including OGC API - Maps.</p>
<div class="admonition question">
<p class="admonition-title">Interact with OGC API - Maps via OWSLib</p>
<p>If you do not have Python installed, consider running this exercise in a Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-ogcapi-maps-__tabbed_1_1" name="publishing-ogcapi-maps-__tabbed_1" type="radio" /><input id="publishing-ogcapi-maps-__tabbed_1_2" name="publishing-ogcapi-maps-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-maps-__tabbed_1_1">Linux/Mac</label><label for="publishing-ogcapi-maps-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Now running in Python:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-ogcapi-maps-__tabbed_2_1" name="publishing-ogcapi-maps-__tabbed_2" type="radio" /><input id="publishing-ogcapi-maps-__tabbed_2_2" name="publishing-ogcapi-maps-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-maps-__tabbed_2_1">Linux/Mac</label><label for="publishing-ogcapi-maps-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.maps</span><span class="w"> </span><span class="kn">import</span> <span class="n">Maps</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Maps</span><span class="p">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;airports&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.png&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.maps</span><span class="w"> </span><span class="kn">import</span> <span class="n">Maps</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Maps</span><span class="p">(</span><span class="s1">&#39;http://localhost:5000&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;airports&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.png&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">())</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the official <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">OWSLib documentation</a> for more examples.</p>
</div>
<h1 id="publishing-ogcapi-maps-summary">Summary</h1>
<p>Congratulations! You are now able to serve an OGC WMS via pygeoapi and OGC API - Maps.</p></section><section class="print-page" id="publishing-ogcapi-tiles" heading-number="5.6"><h1 id="publishing-ogcapi-tiles-exercise-5-tiles-of-geospatial-data-via-ogc-api-tiles">Exercise 5 - Tiles of geospatial data via OGC API - Tiles</h1>
<p><a href="https://ogcapi.ogc.org/tiles">OGC API - Tiles</a> provides a Web API to deliver tiles of geospatial information. Different forms of geospatial information are supported, such as tiles of vector features ("vector tiles"), coverages, maps (or imagery) and potentially eventually additional types of tiles of geospatial information. The standard is available on this document:</p>
<ul>
<li><a href="https://docs.ogc.org/is/20-057/20-057.html">OGC API - Tiles: Part 1: Core</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OGC API - Tiles extends the <code>collections/*</code> URL structure (tilesets are listed under <code>/collections/example/tiles</code>:</p>
<div class="highlight"><pre><span></span><code>https://demo.pygeoapi.io/collections/lakes/tiles/WebMercatorQuad/{tileMatrix}/{tileRow}/{tileCol}?f=mvt
</code></pre></div>
</div>
<h2 id="publishing-ogcapi-tiles-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports the core OGC API - Tiles specification, and is able to advertise an existing tileset. Note that pygeoapi itself does not render tiles from source data, but it supports publishing tiles from different <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-tiles.html#providers">backend providers</a>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OGC API - Tiles URL structure is compatible with XYZ layers in common libraries such as OpenLayers, Leaflet and MapML</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-tiles.html">the official documentation</a> for more information on supported tile backends</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>pygeoapi currently supports two well known Tile Matrix Sets: <code>WorldCRS84Quad</code> and <code>WebMercatorQuad</code>. Their definition is published on the <a href="https://demo.pygeoapi.io/master/TileMatrixSets">/TileMatrixSets</a> end point.  </p>
</div>
<h2 id="publishing-ogcapi-tiles-publish-pre-rendered-vector-tiles">Publish pre-rendered vector tiles</h2>
<p>In this scenario, tiles must be pre-rendered before serving. The <code>MVT-tippecanoe</code> provider enables serving tiles pre-rendered by <a href="https://github.com/mapbox/tippecanoe">tippecanoe</a>, either from a path on disk or from a static server (e.g.: S3 or MinIO bucket).</p>
<p>For this exercise, you will publish a vector dataset of the <a href="https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about">greater Hyderabad municipal corporation ward boundaries</a>, from the location below:</p>
<ul>
<li>data: <code>workshop/exercises/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code></li>
</ul>
<p>Let's generate the tiles as the first step using tippecanoe:</p>
<div class="admonition example">
<p class="admonition-title">Using tippecanoe to generate vector tiles</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-ogcapi-tiles-__tabbed_1_1" name="publishing-ogcapi-tiles-__tabbed_1" type="radio" /><input id="publishing-ogcapi-tiles-__tabbed_1_2" name="publishing-ogcapi-tiles-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-tiles-__tabbed_1_1">Linux/Mac</label><label for="publishing-ogcapi-tiles-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/data<span class="w"> </span>emotionalcities/tippecanoe<span class="w"> </span><span class="se">\</span>
tippecanoe<span class="w"> </span>-r1<span class="w"> </span>-pk<span class="w"> </span>-pf<span class="w"> </span>--output-to-directory<span class="o">=</span>/data/tiles/<span class="w"> </span>--force<span class="w"> </span>--maximum-zoom<span class="o">=</span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
--extend-zooms-if-still-dropping<span class="w"> </span>--no-tile-compression<span class="w"> </span>/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/data<span class="w"> </span>emotionalcities/tippecanoe<span class="w"> </span>tippecanoe<span class="w"> </span>-r1<span class="w"> </span>-pk<span class="w"> </span>-pf<span class="w"> </span>--output-to-directory<span class="o">=</span>/data/tiles/<span class="w"> </span>--force<span class="w"> </span>--maximum-zoom<span class="o">=</span><span class="m">16</span><span class="w"> </span>--extend-zooms-if-still-dropping<span class="w"> </span>--no-tile-compression<span class="w"> </span>/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that the tippecanoe tool requires the input file to be in WGS84, and it always outputs tiles in WebMercator.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration in a text editor. Add a new dataset section as follows:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">hyderabad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Greater Hyderabad Municipal Corporation ward boundaries</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The city ward boundaries represent the administrative and electoral boundary areas of the city. It plays a great role in planning of the city, for each council of the municipal corporation.</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Boundaries</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ward</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">78.2379194985166180</span><span class="p p-Indicator">,</span><span class="nv">17.2908061510471995</span><span class="p p-Indicator">,</span><span class="nv">78.6217049083810764</span><span class="p p-Indicator">,</span><span class="nv">17.5618443356918768</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2011-11-11</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GeoJSON</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">objectid</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tile</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MVT-tippecanoe</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/tiles/</span><span class="w">  </span><span class="c1"># local directory tree</span>
<span class="w">              </span><span class="nt">options</span><span class="p">:</span>
<span class="w">                </span><span class="nt">zoom</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">                    </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">              </span><span class="nt">format</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pbf</span>
<span class="w">                    </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/vnd.mapbox-vector-tile</span>
</code></pre></div></td></tr></table></div>
<p>Save the file and restart Docker Compose. Navigate to <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> to evaluate whether the new dataset has been published.</p>
<p>Additional check for the following tile specific endpoints in the <code>hyderabad</code> collection:</p>
<ul>
<li>tile links in <a href="http://localhost:5000/collections/hyderabad/tiles">http://localhost:5000/collections/hyderabad/tiles</a></li>
<li>tile metadata in <a href="http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata">http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata</a></li>
</ul>
<p><img alt="TileSet" src="../assets/images/vtiles-hyderabad.png" /></p>
<h2 id="publishing-ogcapi-tiles-publish-vector-tiles-from-elasticsearch">Publish vector tiles from Elasticsearch</h2>
<p>Elasticsearch provides a middleware that <a href="https://www.elastic.co/blog/introducing-elasticsearch-vector-tile-search-api-for-geospatial">renders an index on the fly, as vector tiles</a>. This middleware is also supported by the pygeoapi mvt backend.</p>
<p>If you want to explore publishing vector tiles using Elasticsearch clone <a href="https://github.com/geopython/pygeoapi-examples/">pygeoapi-examples</a> repository:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-ogcapi-tiles-__tabbed_2_1" name="publishing-ogcapi-tiles-__tabbed_2" type="radio" /><input id="publishing-ogcapi-tiles-__tabbed_2_2" name="publishing-ogcapi-tiles-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-tiles-__tabbed_2_1">Linux/Mac</label><label for="publishing-ogcapi-tiles-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/geopython/pygeoapi-examples.git
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then change into the <code>docker/mvt-elastic</code> folder:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="publishing-ogcapi-tiles-__tabbed_3_1" name="publishing-ogcapi-tiles-__tabbed_3" type="radio" /><input id="publishing-ogcapi-tiles-__tabbed_3_2" name="publishing-ogcapi-tiles-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-tiles-__tabbed_3_1">Linux/Mac</label><label for="publishing-ogcapi-tiles-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/mvt-elastic
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>docker/mvt-elastic
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Edit the <code>add-data.sh</code> script on the <code>ES</code> folder, adding these two lines before the end:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">curl -o /tmp/hyderabad.geojson https://raw.githubusercontent.com/geopython/diving-into-pygeoapi/refs/heads/main/workshop/exercises/data/hyderabad/greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">python3 /load_es_data.py /tmp/hyderabad.geojson objectid</span>
</code></pre></div></td></tr></table></div>
<p>Above we are downloading the <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> inside the container, and ingesting it into an Elasticsearch index. After this we need to build the docker image:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="publishing-ogcapi-tiles-__tabbed_4_1" name="publishing-ogcapi-tiles-__tabbed_4" type="radio" /><input id="publishing-ogcapi-tiles-__tabbed_4_2" name="publishing-ogcapi-tiles-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-tiles-__tabbed_4_1">Linux/Mac</label><label for="publishing-ogcapi-tiles-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>build
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Edit the <code>docker.config.yml</code> configuration on the <code>pygeoapi</code> folder, adding this code block before the end:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">hyderabad</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Greater Hyderabad Municipal Corporation ward boundaries</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The city ward boundaries represent the administrative and electoral boundary areas of the city. It plays a great role in planning of the city, for each council of the municipal corporation.</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Boundaries</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative</span>
<span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ward</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://livingatlas-dcdev.opendata.arcgis.com/datasets/a090c89d52f1498f96a82e97b8bfb83e_0/about</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">78.2379194985166180</span><span class="p p-Indicator">,</span><span class="nv">17.2908061510471995</span><span class="p p-Indicator">,</span><span class="nv">78.6217049083810764</span><span class="p p-Indicator">,</span><span class="nv">17.5618443356918768</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2011-11-11</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class="w">  </span><span class="c1"># or empty</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Elasticsearch</span>
<span class="w">              </span><span class="c1">#Note elastic_search is the docker container of ES the name is defined in the docker-compose.yml</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://elastic_search:9200/hyderabad</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">objectid</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tile</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MVT-elastic</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://elastic_search:9200/hyderabad/_mvt/geometry/{z}/{x}/{y}?grid_precision=0</span>
<span class="w">              </span><span class="c1"># index must have a geo_point</span>
<span class="w">              </span><span class="nt">options</span><span class="p">:</span>
<span class="w">                </span><span class="nt">zoom</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">                    </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">29</span>
<span class="w">              </span><span class="nt">format</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pbf</span>
<span class="w">                    </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/vnd.mapbox-vector-tile</span>
</code></pre></div></td></tr></table></div>
<p>This configuration enables publishing <code>greater_hyderabad_municipal_corporation_ward_Boundaries.geojson</code> as both, OGC API - Features and OGC API - Tiles.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The elastic Vector tile search API supports zoom levels 0-29</p>
</div>
<p>Finally start the docker composition, which will download and ingest the dataset and publish it in pygeoapi:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="publishing-ogcapi-tiles-__tabbed_5_1" name="publishing-ogcapi-tiles-__tabbed_5" type="radio" /><input id="publishing-ogcapi-tiles-__tabbed_5_2" name="publishing-ogcapi-tiles-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-tiles-__tabbed_5_1">Linux/Mac</label><label for="publishing-ogcapi-tiles-__tabbed_5_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up
</code></pre></div>
</div></p>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can check your elastic index at:
<a href="http://localhost:9200/_cat/indices">http://localhost:9200/_cat/indices</a></p>
<p>If you are in production, you may want to close the elastic ports on docker-compose.</p>
</div>
<h2 id="publishing-ogcapi-tiles-client-access">Client access</h2>
<h3 id="publishing-ogcapi-tiles-qgis">QGIS</h3>
<p>QGIS supports OGC API Vector Tiles via the <a href="https://docs.qgis.org/3.40/en/docs/user_manual/working_with_vector_tiles/vector_tiles_properties.html">Vector Tiles Layer</a>. Although OGC API - Tiles are not natively supported, you can customize the <code>generic connection</code> in order to access them in QGIS.</p>
<div class="admonition question">
<p class="admonition-title">Access OGC API Vector Tiles from QGIS</p>
<p>Before entering QGIS, access your pygeoapi installation page on the browser and follow these steps.</p>
<ul>
<li>access the collection page of the tiles dataset: <a href="http://localhost:5000/collections/hyderabad">http://localhost:5000/collections/hyderabad</a></li>
<li>navigate to the tiles page by clicking on <code>tiles</code>: <a href="http://localhost:5000/collections/hyderabad/tiles">http://localhost:5000/collections/hyderabad/tiles</a></li>
<li>click in <code>Tiles metadata</code>: <a href="http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata">http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/metadata</a></li>
<li>note the URL template: <code>http://localhost:5000/collections/hyderabad/tiles/WebMercatorQuad/{tileMatrix}/{tileRow}/{tileCol}?f=mvt</code> and of the values of minZoom and maxZoom</li>
</ul>
<p>Follow these steps to connect to a service and access vector tiles:</p>
<ul>
<li>
<p>locate the vector tiles service on the left hand side browser panel. Note that you can also use the top menu and navigate to <code>Layer &gt; Add Layer &gt; Vector Tile Layer</code></p>
</li>
<li>
<p>right-click to bring up the context menu and choose <code>New Generic connection</code></p>
</li>
<li>fill the required values. For URL, use the URL you noted from the previous step, replacing <code>{tileMatrix}/{tileRow}/{tileCol}</code> with <code>{z}/{y}/{x}</code>.</li>
</ul>
<p><img alt="" src="../assets/images/qgis-vtiles-hyderabad1.png" width="100%" /></p>
<ul>
<li>press <code>OK</code> to add the service. At this point, if you should see the connection appear it. Click <code>Add</code> to add it to the map</li>
<li>Zoom in to Hyderabad to visualize your dataset</li>
</ul>
<p><img alt="" src="../assets/images/qgis-vtiles-hyderabad2.png" width="100%" /></p>
<p><img alt="" src="../assets/images/qgis-vtiles-hyderabad3.png" width="100%" /></p>
</div>
<h3 id="publishing-ogcapi-tiles-leafletjs">LeafletJS</h3>
<p><a href="https://leafletjs.com">LeafletJS</a> is a popular JavaScript library to add interactive maps to websites. LeafletJS does not support OGC API's explicitly, however can interact with OGC API by using the results of the API directly.</p>
<div class="admonition question">
<p class="admonition-title">Add OGC API - Tiles to a website with LeafletJS</p>
<ul>
<li>copy the HTML below to a file called <code>vector-tiles.html</code>, or locate this file in <code>workshop/exercises/html</code></li>
<li>open the file in a web browser</li>
</ul>
<p>The code uses the LeafletJS library with the <a href="https://github.com/Leaflet/Leaflet.VectorGrid">leaflet.vectorgrid</a> plugin to display the lakes OGC API - Tiles service on top of a base layer.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;&lt;</span><span class="nt">title</span><span class="p">&gt;</span>OGC API - Tiles exercise<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:100vw;height:100vh;&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/leaflet@1.0.3/dist/leaflet.css&quot;</span> <span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/leaflet@1.3.1/dist/leaflet.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="w">    </span>
<span class="nx">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">).</span><span class="nx">setView</span><span class="p">({</span><span class="w"> </span><span class="nx">lat</span><span class="o">:</span><span class="w"> </span><span class="mf">17.425181</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="o">:</span><span class="w"> </span><span class="mf">78.5493906</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="mf">11</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span>
<span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">attribution</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Tiles &amp;copy; Esri &amp;mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">minZoom</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">maxZoom</span><span class="o">:</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span>
<span class="w">    </span><span class="p">}));</span>
<span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getColor</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#f2e6c7&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#8fa37e&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#f0d17d&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">120</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w">  </span><span class="s2">&quot;#d7ded1&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;#c2d0d9&quot;</span><span class="p">;</span>
<span class="w"> </span><span class="p">}</span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">vectorTileStyling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">greater_hyderabad_municipal_corporation_ward_Boundaries</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">properties</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">({</span>
<span class="w">            </span><span class="nx">fill</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nx">fillColor</span><span class="o">:</span><span class="w"> </span><span class="nx">getColor</span><span class="p">(</span><span class="nx">properties</span><span class="p">.</span><span class="nx">objectid</span><span class="p">),</span>
<span class="w">            </span><span class="nx">color</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">fillOpacity</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">            </span><span class="nx">weight</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span>
<span class="w">            </span><span class="c1">//color: &quot;#ffffff&quot;,</span>
<span class="w">            </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">mapVectorTileOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rendererFactory</span><span class="o">:</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">tile</span><span class="p">,</span>
<span class="w">        </span><span class="nx">interactive</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">vectorTileLayerStyles</span><span class="o">:</span><span class="w"> </span><span class="nx">vectorTileStyling</span><span class="p">,</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pbfURL</span><span class="o">=</span><span class="s1">&#39;http://localhost:5000/collections/hyderabad/tiles/WorldCRS84Quad/{z}/{y}/{x}?f=mvt&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">pbfLayer</span><span class="o">=</span><span class="nx">L</span><span class="p">.</span><span class="nx">vectorGrid</span><span class="p">.</span><span class="nx">protobuf</span><span class="p">(</span><span class="nx">pbfURL</span><span class="p">,</span><span class="nx">mapVectorTileOptions</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">layer</span><span class="p">);</span>
<span class="w">    </span><span class="nx">L</span><span class="p">.</span><span class="nx">DomEvent</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="w">    </span><span class="p">}).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span><span class="w"> </span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>In this example, the colors of the symbols reflect the value of the <code>objectid</code> attribute.</p>
<p><img alt="" src="../assets/images/leaflet-hyderabad.png" width="100%" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can check the layer attributes, by opening the console in the developer tools.
<img alt="" src="../assets/images/vtiles-attributes.png" width="100%" /></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Try adding a <a href="https://demo.pygeoapi.io/master/collections/lakes/tiles/WorldCRS84Quad/metadata">different pygeoapi vector tiles layer</a> by updating the code in <code>workshop/exercises/html/vector-tiles.html</code>.</p>
<p>If you want to render the tiles from the <a href="#publishing-ogcapi-tiles-publish-vector-tiles-from-elasticsearch">Elasticsearch example</a>, you can check out the code from <a href="https://github.com/doublebyte1/vtiles-example/blob/ogcapi-ws/demo-oat.htm">this</a> repository:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="publishing-ogcapi-tiles-__tabbed_6_1" name="publishing-ogcapi-tiles-__tabbed_6" type="radio" /><input id="publishing-ogcapi-tiles-__tabbed_6_2" name="publishing-ogcapi-tiles-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-tiles-__tabbed_6_1">Linux/Mac</label><label for="publishing-ogcapi-tiles-__tabbed_6_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>ogcapi-ws<span class="w"> </span>https://github.com/emotional-cities/vtiles-example.git
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>ogcapi-ws<span class="w"> </span>https://github.com/emotional-cities/vtiles-example.git
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p><img alt="" src="../assets/images/leaflet-hyderabad2.png" width="100%" /></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="https://leafletjs.com/reference.html">official LeafletJS documentation</a></p>
</div>
<h3 id="publishing-ogcapi-tiles-openlayers">OpenLayers</h3>
<p><a href="https://openlayers.org">OpenLayers</a> is a popular JavaScript library to add interactive maps to websites. OpenLayers natively supports OGC API - Tiles (map and vector). You can check the code for the example bellow on: <a href="https://ogcincubator.github.io/ogcapi-tiles-demo/">https://ogcincubator.github.io/ogcapi-tiles-demo/</a></p>
<p><iframe
  src="https://ogcincubator.github.io/ogcapi-tiles-demo/"
  style="width:100%; height:800px;"
></iframe>
</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="https://openlayers.org/en/latest/examples/ogc-vector-tiles.html">official OpenLayers documentation</a></p>
</div>
<h1 id="publishing-ogcapi-tiles-summary">Summary</h1>
<p>Congratulations! You are now able to publish tiles to pygeoapi. You can learn more about this standard on: <a href="https://tiles.developer.ogc.org/">https://tiles.developer.ogc.org/</a></p></section><section class="print-page" id="publishing-ogcapi-records" heading-number="5.7"><h1 id="publishing-ogcapi-records-exercise-6-metadata-via-ogc-api-records">Exercise 6 - Metadata via OGC API - Records</h1>
<p><a href="https://ogcapi.ogc.org/records">OGC API - Records</a> provides a Web API with the capability to create, modify,
and query metadata on the Web:</p>
<ul>
<li>Read the <a href="https://docs.ogc.org/is/20-004r1/20-004r1.html">OGC API - Records: Part 1: Core</a> specification at the OGC website.</li>
</ul>
<p>OGC API - Records uses OGC API - Features as a building block, thus enabling streamlined deployment and integration
for clients and users.</p>
<h2 id="publishing-ogcapi-records-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports the OGC API - Records specification, using Elasticsearch and TinyDB <a href="https://rasterio.readthedocs.io">rasterio</a> as core backends.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-records.html">the official documentation</a> for more information on supported catalogue/metadata backends</p>
</div>
<h2 id="publishing-ogcapi-records-publish-metadata-records-in-pygeoapi">Publish metadata records in pygeoapi</h2>
<p>With pygeoapi we can setup OGC API - Records using any supported data provider. In this exercise we will use the <a href="https://tinydb.readthedocs.io/en/latest/index.html">TinyDB</a>
Catalogue backend. We will use the sample catalogue in <code>workshop/exercises/data/tartu/metadata/catalogue.tinydb</code>.</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration file in a text editor. Add a new dataset section as follows:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">example_catalogue</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOSS4G Europe Estonia national catalogue</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOSS4G Europe Estonia national catalogue</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">estonia</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">catalogue</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOSS4G Europe</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://metadata.geoportaal.ee</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">23.3397953631</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">57.4745283067</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">28.1316992531</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">59.6110903998</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">record</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TinyDBCatalogue</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/tartu/metadata/catalogue.tinydb</span>
<span class="w">              </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">externalId</span>
<span class="w">              </span><span class="nt">time_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">recordCreated</span>
<span class="w">              </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">title</span>
</code></pre></div></td></tr></table></div>
<p>Save the configuration and restart Docker Compose. Navigate to <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> to evaluate whether the new dataset has been published.</p>
<h2 id="publishing-ogcapi-records-metadata-formats">Metadata formats</h2>
<p>By default, pygeoapi supports and expects the OGC API - Records core record model and queryables. For additional metadata formats, you can
develop your own custom pygeoapi plugin, or convert your metadata to OGC API - Records core record model before adding to pygeoapi.</p>
<div class="admonition question">
<p class="admonition-title">Install OWSLib</p>
<p>If you do not have Python installed, consider running this exercise in a Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-ogcapi-records-__tabbed_1_1" name="publishing-ogcapi-records-__tabbed_1" type="radio" /><input id="publishing-ogcapi-records-__tabbed_1_2" name="publishing-ogcapi-records-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-records-__tabbed_1_1">Linux/Mac</label><label for="publishing-ogcapi-records-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h3 id="publishing-ogcapi-records-sample-iso-19139-to-tinydbcatalogue-loader">Sample ISO 19139 to TinyDBCatalogue loader</h3>
<p>It is possible to load more example ISO19139 metadata in a TinyDB database with <a href="https://github.com/geopython/pygeoapi/blob/master/tests/load_tinydb_records.py">the following script</a> (<a href="https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py">raw</a>):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-ogcapi-records-__tabbed_2_1" name="publishing-ogcapi-records-__tabbed_2" type="radio" /><input id="publishing-ogcapi-records-__tabbed_2_2" name="publishing-ogcapi-records-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-records-__tabbed_2_1">Linux/Mac</label><label for="publishing-ogcapi-records-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises/data/tartu/metadata
curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>xml<span class="w"> </span>catalogue.tinydb
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises/data/tartu/metadata
curl<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>xml<span class="w"> </span>catalogue.tinydb
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>If you do not have curl installed, copy the URL above to your web browser and save locally.</p>
<p>If you do not have Python installed, you can the loader by using the OWSLib Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>.</p>
<div class="admonition example">
<p class="admonition-title">Using the OWSLib Docker container to load metadata</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="publishing-ogcapi-records-__tabbed_3_1" name="publishing-ogcapi-records-__tabbed_3" type="radio" /><input id="publishing-ogcapi-records-__tabbed_3_2" name="publishing-ogcapi-records-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-records-__tabbed_3_1">Linux/Mac</label><label for="publishing-ogcapi-records-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/data:/data<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
pip3<span class="w"> </span>install<span class="w"> </span>owslib
apt-get<span class="w"> </span>update<span class="w"> </span>-y<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>curl<span class="w"> </span>-y
curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>/data/tartu/metadata/xml<span class="w"> </span>/data/tartu/metadata/catalogue.tinydb
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>workshop/exercises
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--network<span class="o">=</span>host<span class="w"> </span>--name<span class="w"> </span>owslib<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/data:/data<span class="w"> </span>python:3.10-slim<span class="w"> </span>/bin/bash
pip3<span class="w"> </span>install<span class="w"> </span>owslib
apt-get<span class="w"> </span>update<span class="w"> </span>-y<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>curl<span class="w"> </span>-y
curl<span class="w"> </span>-O<span class="w"> </span>https://raw.githubusercontent.com/geopython/pygeoapi/master/tests/load_tinydb_records.py
python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>/data/tartu/metadata/xml<span class="w"> </span>/data/tartu/metadata/catalogue.tinydb
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>Navigate to <a href="http://localhost:5000/collections/example_catalogue">http://localhost:5000/collections/example_catalogue</a> to evaluate whether the new metadata has been published
to the collection.</p>
<div class="admonition tip pygeometa">
<p class="admonition-title">Tip</p>
<p><a href="https://geopython.github.io/pygeometa">pygeometa</a> is a Python package to generate metadata for geospatial
datasets.  pygeometa allows for managing metadata in simple YAML "metadata control files (MCF), and supports
import, export as well as transformations for many geospatial metadata formats.  OGC API - Records metadata
can be produced using pygeometa, either from MCF files or transforming from other formats.</p>
<p>Install and run pygeometa per below to get an idea of the various commands and functionality (as well,
consult the <a href="https://geopython.github.io/pygeometa/tutorial">tutorial</a>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="publishing-ogcapi-records-__tabbed_4_1" name="publishing-ogcapi-records-__tabbed_4" type="radio" /><input id="publishing-ogcapi-records-__tabbed_4_2" name="publishing-ogcapi-records-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-records-__tabbed_4_1">Linux/Mac</label><label for="publishing-ogcapi-records-__tabbed_4_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>pygeometa
pygeometa<span class="w"> </span>--help
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>pygeometa
pygeometa<span class="w"> </span>--help
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<h2 id="publishing-ogcapi-records-pygeoapi-as-a-csw-proxy">pygeoapi as a CSW proxy</h2>
<p>You can check the "pygeoapi as a Bridge to Other Services" section to learn how to <a href="#advanced-bridges-publishing-csw-as-ogc-api-records">publish CSW as OGC API - Records</a>.</p>
<h2 id="publishing-ogcapi-records-client-access">Client access</h2>
<h3 id="publishing-ogcapi-records-qgis">QGIS</h3>
<p>QGIS supports OGC API - Records via the <a href="https://docs.qgis.org/latest/en/docs/user_manual/plugins/core_plugins/plugins_metasearch.html">MetaSearch plugin</a>. MetaSearch originally focused on Catalogue Service for the Web (OGC:CSW) only, but has been extended to OGC API - Records. MetaSearch is a default plugin in QGIS and requires no further installation.</p>
<div class="admonition question">
<p class="admonition-title">Query OGC API - Records from QGIS</p>
<p>Follow these steps to connect to a service and query datasets:</p>
<ul>
<li>Locate the MetaSearch plugin in the Web menu or on the Toolbar <img alt="MetaSearch icon" src="https://docs.qgis.org/latest/en/_images/MetaSearch.png" title="MetaSearch icon" />. The main search panel will appear with the default MetaSearch catalogue list already populated.</li>
</ul>
<p><img alt="Pre-populated catalogues" src="../assets/images/prepopulated-catalogues.png" width="50%" /></p>
<ul>
<li>open the <code>Services</code> tab, to find the <code>New</code> button to create a new connection</li>
<li>add a connection to <code>https://demo.pygeoapi.io/master</code></li>
<li>click <code>Service Info</code> to get information about the service</li>
<li>return to the Search tab</li>
<li>select the connection you have just created</li>
<li>type a search term and click <code>search</code></li>
<li>notice that when you select a search result, a red footprint is drawn on the map highlighting the location of the dataset</li>
</ul>
<p><img alt="Search results" src="../assets/images/search-results.png" width="50%" /></p>
</div>
<p><a href="https://owslib.readthedocs.io">OWSLib</a> is a Python library to interact with OGC Web Services and supports a number of OGC APIs including OGC API - Records.</p>
<div class="admonition question">
<p class="admonition-title">Interact with OGC API - Records via OWSLib</p>
<p>If you do not have Python installed, consider running this exercise in a Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="publishing-ogcapi-records-__tabbed_5_1" name="publishing-ogcapi-records-__tabbed_5" type="radio" /><input id="publishing-ogcapi-records-__tabbed_5_2" name="publishing-ogcapi-records-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-records-__tabbed_5_1">Linux/Mac</label><label for="publishing-ogcapi-records-__tabbed_5_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then start a Python console session with <code>python3</code> (stop the session by typing <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="publishing-ogcapi-records-__tabbed_6_1" name="publishing-ogcapi-records-__tabbed_6" type="radio" /><input id="publishing-ogcapi-records-__tabbed_6_2" name="publishing-ogcapi-records-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-records-__tabbed_6_1">Linux/Mac</label><label for="publishing-ogcapi-records-__tabbed_6_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.records</span><span class="w"> </span><span class="kn">import</span> <span class="n">Records</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Records</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;dutch-metadata&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">198</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberReturned&#39;</span><span class="p">]</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="s1">&#39;Wegpanorama&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">2</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.records</span><span class="w"> </span><span class="kn">import</span> <span class="n">Records</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">SERVICE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://demo.pygeoapi.io/master/&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Records</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="s1">&#39;dutch-metadata&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
<span class="s1">&#39;Sample metadata records from Dutch Nationaal georegister&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">198</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberReturned&#39;</span><span class="p">]</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection_items</span><span class="p">(</span><span class="s1">&#39;dutch-metadata&#39;</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="s1">&#39;Wegpanorama&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dutch_metacat_query</span><span class="p">[</span><span class="s1">&#39;numberMatched&#39;</span><span class="p">]</span>
<span class="mi">2</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the official <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">OWSLib documentation</a> for more examples.</p>
</div>
<h1 id="publishing-ogcapi-records-summary">Summary</h1>
<p>Congratulations!  You are now able to publish metadata to pygeoapi.</p></section><section class="print-page" id="publishing-ogcapi-edr" heading-number="5.8"><h1 id="publishing-ogcapi-edr-exercise-7-environmental-data-via-ogc-api-environmental-data-retrieval">Exercise 7 - Environmental data via OGC API - Environmental Data Retrieval</h1>
<p><a href="https://ogcapi.ogc.org/edr">OGC API - Environmental Data Retrieval</a> provides a Web API to access
environmental data using well defined query patterns:</p>
<ul>
<li><a href="https://docs.ogc.org/is/19-086r4/19-086r4.html">OGC API - Environmental Data Retrieval Standard</a></li>
</ul>
<p>OGC API - Environmental Data Retrieval uses OGC API - Features as a building block, thus enabling
streamlined integration for clients and users.  EDR can be considered a convenience API which does
not require in depth knowledge about the underlying data store/model.</p>
<h2 id="publishing-ogcapi-edr-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports the OGC API - Environmental Data Retrieval specification by leveraging both feature
and coverage provider plugins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-edr.html">the official documentation</a> for more information on supported EDR backends</p>
</div>
<h2 id="publishing-ogcapi-edr-publish-environmental-data-in-pygeoapi">Publish environmental data in pygeoapi</h2>
<p>Let's try publishing some ICOADS data via the EDR xarray plugin. The sample ICOADS data can be found in <code>workshop/exercises/data/coads_sst.nc</code>:</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration file in a text editor. Add a new dataset section as follows:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">icoads-sst</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">International Comprehensive Ocean-Atmosphere Data Set (ICOADS)</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">International Comprehensive Ocean-Atmosphere Data Set (ICOADS)</span>
<span class="w">        </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">icoads</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sst</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">air temperature</span>
<span class="w">        </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">                </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="nt">temporal</span><span class="p">:</span>
<span class="w">                </span><span class="nt">begin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000-01-16T06:00:00Z</span>
<span class="w">                </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000-12-16T06:00:00Z</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">              </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">              </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">              </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://psl.noaa.gov/data/gridded/data.coads.1deg.html</span>
<span class="w">              </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">        </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edr</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xarray-edr</span>
<span class="w">              </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/coads_sst.nc</span>
<span class="w">              </span><span class="nt">format</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetCDF</span>
<span class="w">                  </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/x-netcdf</span>
</code></pre></div></td></tr></table></div>
<p>Save the configuration and restart Docker Compose. Navigate to <a href="http://localhost:5000/collections">http://localhost:5000/collections</a> to evaluate whether the new dataset has been published.</p>
<p>At first glance, the <code>icoads-sst</code> collection appears as a normal OGC API - Coverages collection. Look a bit closer at the collection description, and notice
that there is a `parameter_names' key that describes EDR parameter names for the collection queries.</p>
<h3 id="publishing-ogcapi-edr-owslib-advanced">OWSLib - Advanced</h3>
<p><a href="https://owslib.readthedocs.io">OWSLib</a> is a Python library to interact with OGC Web Services and supports a number of OGC APIs including OGC API - Environmental Data Retrieval.</p>
<div class="admonition question">
<p class="admonition-title">Interact with OGC API - Environmental Data Retrieval via OWSLib</p>
<p>If you do not have Python installed, consider running this exercise in a Docker container. See the <a href="#setup-using-docker-for-python-clients">Setup Chapter</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="publishing-ogcapi-edr-__tabbed_1_1" name="publishing-ogcapi-edr-__tabbed_1" type="radio" /><input id="publishing-ogcapi-edr-__tabbed_1_2" name="publishing-ogcapi-edr-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-edr-__tabbed_1_1">Linux/Mac</label><label for="publishing-ogcapi-edr-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>owslib
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Then start a Python console session with <code>python3</code> (stop the session by typing <code>exit()</code>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="publishing-ogcapi-edr-__tabbed_2_1" name="publishing-ogcapi-edr-__tabbed_2" type="radio" /><input id="publishing-ogcapi-edr-__tabbed_2_2" name="publishing-ogcapi-edr-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="publishing-ogcapi-edr-__tabbed_2_1">Linux/Mac</label><label for="publishing-ogcapi-edr-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.edr</span><span class="w"> </span><span class="kn">import</span>  <span class="n">EnvironmentalDataRetrieval</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">EnvironmentalDataRetrieval</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># OpenAPI document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;icoads-sst&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span><span class="p">[</span><span class="s1">&#39;parameter-names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">,</span> <span class="s1">&#39;UWND&#39;</span><span class="p">,</span> <span class="s1">&#39;VWND&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">query_data</span><span class="p">(</span><span class="s1">&#39;icoads_sst&#39;</span><span class="p">,</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;POINT(-75 45)&#39;</span><span class="p">,</span> <span class="n">parameter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span>  <span class="c1"># CoverageJSON data</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">owslib.ogcapi.edr</span><span class="w"> </span><span class="kn">import</span>  <span class="n">EnvironmentalDataRetrieval</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">EnvironmentalDataRetrieval</span><span class="p">(</span><span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">url</span>
<span class="s1">&#39;https://demo.pygeoapi.io/master&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">api</span><span class="p">()</span>  <span class="c1"># OpenAPI document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collections</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">collections</span><span class="p">[</span><span class="s1">&#39;collections&#39;</span><span class="p">])</span>
<span class="mi">13</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s1">&#39;icoads-sst&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">icoads_sst</span><span class="p">[</span><span class="s1">&#39;parameter-names&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">,</span> <span class="s1">&#39;UWND&#39;</span><span class="p">,</span> <span class="s1">&#39;VWND&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">query_data</span><span class="p">(</span><span class="s1">&#39;icoads_sst&#39;</span><span class="p">,</span> <span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;POINT(-75 45)&#39;</span><span class="p">,</span> <span class="n">parameter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span> <span class="s1">&#39;AIRT&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span>  <span class="c1"># CoverageJSON data</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the official <a href="https://owslib.readthedocs.io/en/latest/usage.html#ogc-api">OWSLib documentation</a> for more examples.</p>
</div>
<h1 id="publishing-ogcapi-edr-summary">Summary</h1>
<p>Congratulations!  You are now able to publish environmental data to pygeoapi.</p></section><section class="print-page" id="publishing-ogcapi-processes" heading-number="5.9"><h1 id="publishing-ogcapi-processes-exercise-8-functions-via-ogc-api-processes">Exercise 8 - Functions via OGC API - Processes</h1>
<p><a href="https://ogcapi.ogc.org/processes">OGC API - Processes</a> supports the wrapping of computational tasks into
executable processes that can be offered by a server through a Web API and be invoked by a client application.</p>
<ul>
<li><a href="https://docs.ogc.org/is/18-062r2/18-062r2.html">OGC API - Processes: Part 1: Core</a></li>
</ul>
<p>OGC API - Processes uses OGC API - Common as a building block, thus enabling streamlined deployment and integration
for clients and users.</p>
<h2 id="publishing-ogcapi-processes-pygeoapi-support">pygeoapi support</h2>
<p>pygeoapi supports the OGC API - Processes specification, with the ability to publish Python code (no matter how
simple or complex) as an OGC API Process definition.  pygeoapi also support synchronous or asynchronous processing,
with the ability to store and retrive the status/results of 'jobs'.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-processes.html">the official documentation</a> for more information on publishing processes in pygeoapi</p>
</div>
<h2 id="publishing-ogcapi-processes-publishing-python-code-as-a-process-in-pygeoapi">Publishing Python code as a process in pygeoapi</h2>
<p>With pygeoapi we can setup OGC API - Processes using Python code that implements the pygeoapi <code>BaseProcessor</code>, which is a core pygeoapi
abstract base class.  In this exercise we will implemented a "squared" function as a process using the sample Python code in
<code>workshop/exercises/plugins/process/squared.py</code>.  The process is already defined to be part of the pygeoapi environment and configuration.</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration file in a text editor. Add a new process section as follows:</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">squared</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">process</span>
<span class="w">        </span><span class="nt">processor</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pygeoapi.process.squared.SquaredProcessor</span>
</code></pre></div></td></tr></table></div>
<div class="admonition question">
<p class="admonition-title">Update Python code</p>
<p>Open the Python code at <code>workshop/exercises/plugins/process/squared.py</code>.  Find the <code>execute</code> function and update the Python
code to calculate the input value squared.</p>
</div>
<p>Save the configuration and restart Docker Compose. Navigate to <a href="http://localhost:5000/processes">http://localhost:5000/processes</a> to evaluate whether the new process has
been published.  Inspect the detailed process metadata by navigating to <a href="http://localhost:5000/processes/squared">http://localhost:5000/processes/squared</a> to inspect how the process
metadata defined in the Python code/file is made available in JSON..</p>
<h2 id="publishing-ogcapi-processes-client-access">Client access</h2>
<h3 id="publishing-ogcapi-processes-swagger">Swagger</h3>
<p>The easiest way to test the new process is by using pygeoapi's built in Swagger interface.  Navigate to <a href="http://localhost:5000/openapi">http://localhost:5000/openapi</a> and try out
the process in the Swagger UI.</p>
<p><img alt="Squared function process execution" src="../assets/images/oaproc-squared-1.png" width="120%" /></p>
<p><img alt="Squared function process execution" src="../assets/images/oaproc-squared-2.png" width="120%" /></p>
<p><img alt="Squared function process execution" src="../assets/images/oaproc-squared-3.png" width="120%" /></p>
<h1 id="publishing-ogcapi-processes-summary">Summary</h1>
<p>Congratulations!  You are now able to publish Python code as a process to pygeoapi.</p></section></section>
                    <section class='print-page md-section' id='section-6' heading-number='6'>
                        <h1>Advanced topics<a class='headerlink' href='#section-6' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="advanced" heading-number="6.1"><h1 id="advanced-advanced-topics">Advanced topics</h1>
<p>In this section, we will discuss more advanced pygeoapi topics primarily
focused on extending pygeoapi via custom development and deployment.</p>
<ul>
<li><a href="#advanced-i18n">Multilingual support</a></li>
<li><a href="#advanced-crs">CRS support</a></li>
<li><a href="#advanced-ui-custom-templates">UI customization and templating</a></li>
<li><a href="#advanced-downstream-applications">Using pygeoapi in downstream applications</a></li>
<li><a href="#advanced-seo">Search Engine Optimization (SEO)</a></li>
<li><a href="#advanced-security-access-control">Security and access control</a></li>
<li><a href="#advanced-semantic-web-linked-data">Semantic Web and Linked Data</a></li>
<li><a href="#advanced-cloud">Cloud deployment</a></li>
<li><a href="#advanced-inspire">INSPIRE support</a></li>
<li><a href="#advanced-bridges">pygeoapi as a Bridge to Other Services</a></li>
</ul></section><section class="print-page" id="advanced-i18n" heading-number="6.2"><h1 id="advanced-i18n-multilingual-support">Multilingual support</h1>
<p>pygeoapi supports multilinguality at three levels:</p>
<ul>
<li>In the pygeoapi configuration you can provide titles and abstracts of the service and collections in multiple languages.</li>
<li>A set of translatable text-strings which are translated and introduced as part of the JSON and HTML output formats. Translations are managed by the <a href="https://babel.pocoo.org">Babel framework</a></li>
<li>Column names/values in feature based datasets. If a dataset contains columns in multiple languages, pygeoapi will try to return data responses in the requested language</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Error messages are not translated, to facilitate copy-paste of the error into 
<a href="https://stackoverflow.com/search?q=pygeoapi">stackoverflow</a> and 
<a href="https://github.com/geopython/pygeoapi/issues">GitHub issues</a>.</p>
</div>
<p>Language negotiation is triggered by the HTTP <code>Accept-Language</code> header as sent by the client, and can always be overridden with the <code>?lang=fr</code> url parameter.</p>
<h2 id="advanced-i18n-multilingual-configuration">Multilingual configuration</h2>
<p>In the pygeoapi configuration you can indicate the languages supported by the instance. The first language is the default language. For most of the textual configuration properties you can provide a translation in alternative languages.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">lakes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">  </span><span class="nt">title</span><span class="p">:</span>
<span class="w">      </span><span class="nt">en</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Large Lakes</span>
<span class="w">      </span><span class="nt">fr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Grands Lacs</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span>
<span class="w">      </span><span class="nt">en</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lakes of the world, public domain</span>
<span class="w">      </span><span class="nt">fr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lacs du monde, domaine public</span>
<span class="w">  </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">      </span><span class="nt">en</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lakes</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">water bodies</span>
<span class="w">      </span><span class="nt">fr</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lacs</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">plans d&#39;eau</span>
</code></pre></div></td></tr></table></div>
<h2 id="advanced-i18n-text-strings-within-jinja2-html-templates">Text strings within Jinja2 HTML templates</h2>
<p>Most of the translatable text strings exist within the Jinja2 HTML templates. Text strings to be translated are placed in a <code>trans</code> tag, as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{% trans %}Page title{% endtrans %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>Babel provides a utility which extracts all keys to be translated from the templates into a single <code>.pot</code> file. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="advanced-i18n-__tabbed_1_1" name="advanced-i18n-__tabbed_1" type="radio" /><input id="advanced-i18n-__tabbed_1_2" name="advanced-i18n-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="advanced-i18n-__tabbed_1_1">Linux/Mac</label><label for="advanced-i18n-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>extract<span class="w"> </span>-F<span class="w"> </span>babel-mapping.ini<span class="w"> </span>-o<span class="w"> </span>locale/messages.pot<span class="w"> </span>./
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>extract<span class="w"> </span>-F<span class="w"> </span>babel-mapping.ini<span class="w"> </span>-o<span class="w"> </span>locale/messages.pot<span class="w"> </span>./
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>The resulting <code>.pot</code> file is used to create or update existing <code>.po</code> files, which exist for each language, containing the actual translations.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="advanced-i18n-__tabbed_2_1" name="advanced-i18n-__tabbed_2" type="radio" /><input id="advanced-i18n-__tabbed_2_2" name="advanced-i18n-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="advanced-i18n-__tabbed_2_1">Linux/Mac</label><label for="advanced-i18n-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span>locale<span class="w"> </span>-l<span class="w"> </span>it<span class="w"> </span>-i<span class="w"> </span>locale/messages.pot
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>pybabel<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span>locale<span class="w"> </span>-l<span class="w"> </span>it<span class="w"> </span>-i<span class="w"> </span>locale/messages.pot
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>The <code>.po</code> files are stored in pygeoapi's source code repository on GitHub. You can create a Pull Request to add or update your favourite languages. <code>.po</code> files can also be added to translation software such as <a href="https://transifex.com">transifex.com</a>. </p>
<div class="admonition question">
<p class="admonition-title">Edit a <code>.po</code> file</p>
<p>Open a <code>.po</code> file from the <a href="https://github.com/geopython/pygeoapi/tree/master/locale">locale</a> folder in a text editor. Edit some values. Save the file and restart the service. Verify that the updated content is available. You can also try to add a new key to a template and translate it via the <code>.po</code> mechanism.</p>
</div>
<h2 id="advanced-i18n-annotating-the-language-of-data-columns">Annotating the language of data columns</h2>
<p>pygeoapi includes a meachanism to influence the API responses based on the requested language. If your service operates with multilingual requirements, it may make sense to add textual columns in multiple languages. For example, in the pygeoapi configuration you can then indicate which column should be used as the title field, for which language. </p>
<div class="admonition question">
<p class="admonition-title">Publish a multilingual dataset</p>
<p>For this workshop we have prepared a multilingual dataset of <code>free wifi hotspots in Florence</code> (<code>workshop/exercises/data/free-wifi-florence.csv</code>). Add the dataset to the pygeoapi configuration using the CSV provider. Add a title-field configuration with for each translated column the relevant language.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/free-wifi-florence.csv</span>
<span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="nt">title_field</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="nt">en</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name-en</span>
<span class="w">  </span><span class="nt">it</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name-it</span>
<span class="w">  </span><span class="nt">de</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name-de</span>
</code></pre></div></td></tr></table></div>
<p>Test the configuration by navigating to the items page of the collection and switching the language by appending <code>?lang=it</code>, <code>?lang=de</code> to the URL.</p>
</div>
<h1 id="advanced-i18n-summary">Summary</h1>
<p>Congratulations! You've customized pygeoapi to support multiple languages.</p></section><section class="print-page" id="advanced-crs" heading-number="6.3"><h1 id="advanced-crs-crs-support">CRS support</h1>
<p>Starting with version 0.15.0, pygeoapi fully supports <a href="https://docs.opengeospatial.org/is/18-058r1/18-058r1.html">OGC API - Features - Part 2: Coordinate Reference Systems by Reference</a>.
This enables the import and export of any data according to dedicated projections.
A "projection" is specified with a Coordinate Reference System (CRS) identifier. These are in URI formats
like <code>http://www.opengis.net/def/crs/OGC/1.3/CRS84</code> (basically WGS84 in longitude, latitude axis order)
or the "OpenGIS" format like <code>http://www.opengis.net/def/crs/EPSG/0/4258</code>. Note that the "EPSG:" format like <code>EPSG:4326</code>
is outside the scope of the OGC standard.</p>
<p>In particular CRS support allows for the following:</p>
<ul>
<li>to specify the CRS in which the data is stored, in pygeoapi the <code>storageCRS</code> config option </li>
<li>to specify the list of CRSs in which Feature data can be retrieved, in pygeoapi the <code>crs</code> config option</li>
<li>to publish these CRSs in the collection metadata</li>
<li>the <code>crs=</code> query parameter for a collection or collection item</li>
<li>the <code>bbox-crs=</code> query parameter to indicate that the <code>bbox=</code> parameter is encoded in that CRS</li>
<li>the HTTP response header <code>Content-Crs</code> denotes the CRS of the Feature(s) in the data returned</li>
</ul>
<p>So although GeoJSON mandates WGS84 in longitude, latitude order, the client and server may still agree
on other CRSs.</p>
<p>Under the hood, pygeoapi uses the well-known <a href="https://pyproj4.github.io/pyproj/stable">pyproj</a> Python wrapper to the <a href="https://proj.org">PROJ</a> library.</p>
<p>Read more in the pygeoapi documentation in the <a href="https://docs.pygeoapi.io/en/latest/crs.html">CRS Chapter</a>.</p>
<h1 id="advanced-crs-exercise">Exercise</h1>
<p>Adding CRS support to pygeoapi collections for the <code>provider</code> type <code>feature</code> is as simple as
for example extending the <a href="#publishing-ogcapi-features">Exercise 2</a> config with this snippet:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">crs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4258</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3857</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4326</span>
<span class="w">  </span><span class="nt">storage_crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
</code></pre></div>
<div class="admonition axis order">
<p class="admonition-title">Axis</p>
<p>Axis order (are coordinates it longitude, latitude or latitude, longitude order?) in projections is often a source of confusion. 
However the URI format is quite clear on this, at least more than the <code>EPSG:</code> format.
So http://www.opengis.net/def/crs/OGC/1.3/CRS84 is longitude, latitude order, while
http://www.opengis.net/def/crs/EPSG/0/4326 is latitude, longitude order.</p>
</div>
<p>In the config below, we basically indicate that the data is stored in WGS84 (longitude, latitude axis order) and can be retrieved
in CRSs like <code>http://www.opengis.net/def/crs/EPSG/0/4258</code> (ETRS89 latitude, longitude axis order) etc.</p>
<div class="admonition question">
<p class="admonition-title">Add CRS to a pygeoapi configuration</p>
<p>Open the pygeoapi configuration file in a text editor.
Find the line <code># START - EXERCISE 2 - firenze-terrain</code></p>
<p>Update the dataset section with CRS support by replacing it with the snippet below:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">firenze-terrains-vec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative boundaries before 2014</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cadastral parcels (terrains) from the cadastre. Territory Agency; SIT and Information Networks;</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cadastral parcels</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Administrative boundaries before 2014</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://dati.cittametropolitana.fi.it/geonetwork/srv/metadata/cmfi:c539d359-4387-4f83-a6f4-cd546b3d8443</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">it</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">11.23</span><span class="p p-Indicator">,</span><span class="nv">43.75</span><span class="p p-Indicator">,</span><span class="nv">11.28</span><span class="p p-Indicator">,</span><span class="nv">43.78</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SQLiteGPKG</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/firenze_terrains.gpkg</span><span class="w"> </span><span class="c1"># place correct path here</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fid</span>
<span class="w">          </span><span class="nt">crs</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4258</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3857</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4326</span>
<span class="w">          </span><span class="nt">storage_crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">          </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codbo</span>
<span class="w">          </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">firenze_terrains</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Now we can inspect the collection metadata and retrieve Features in various CRSs.
We can even do this in the Swagger UI, but using the browser is quite fast and clear.</p>
<h2 id="advanced-crs-metadata">Metadata</h2>
<div class="admonition question">
<p class="admonition-title">Collection Metadata</p>
<p>Open the URL: 
<a href="http://localhost:5000/collections/firenze-terrains-vec">http://localhost:5000/collections/firenze-terrains-vec</a>
Your configured CRSs are displayed at the bottom of the page: "Reference Systems" and "Storage CRS".</p>
<p>See these in JSON format, also at the bottom: 
<a href="http://localhost:5000/collections/firenze-terrains-vec?f=json">http://localhost:5000/collections/firenze-terrains-vec?f=json</a>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">&quot;crs&quot;:[</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/EPSG/0/4258&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/EPSG/0/3857&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;http://www.opengis.net/def/crs/EPSG/0/4326&quot;</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">],</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">&quot;storageCRS&quot;:&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">}</span>
</code></pre></div></p>
</div>
<h2 id="advanced-crs-reproject-features">Reproject Features</h2>
<div class="admonition question">
<p class="admonition-title">Using the CRS query parameter</p>
<p>Open the URL: 
<a href="http://localhost:5000/collections/firenze-terrains-vec/items?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258">http://localhost:5000/collections/firenze-terrains-vec/items?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258</a></p>
<p>This is ETRS89, similar to WGS84, but for the European Continent (Datum) and in lat,lon order. This is e.g. used in INSPIRE.</p>
<p>See these in JSON format, also at the bottom:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;features&quot;</span><span class="p">:[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;geometry&quot;</span><span class="p">:{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;MultiPolygon&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span>
<span class="w">                  </span><span class="p">[</span>
<span class="w">                      </span><span class="p">[</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77805936835436</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.23486287997071</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77809089595012</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.2348943159564</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77810038978989</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.23491359066035</span>
<span class="w">                          </span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span>
<span class="w">                              </span><span class="mf">43.77705757917591</span><span class="p">,</span>
<span class="w">                              </span><span class="mf">11.2368990806804</span>
<span class="w">   </span><span class="err">.</span>
<span class="w">   </span><span class="err">.</span>
<span class="w">   </span><span class="nt">&quot;crs&quot;</span><span class="p">:[</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/EPSG/0/4258&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/EPSG/0/3857&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;http://www.opengis.net/def/crs/EPSG/0/4326&quot;</span>
<span class="w">   </span><span class="p">],</span>
<span class="w">   </span><span class="nt">&quot;storageCRS&quot;</span><span class="p">:</span><span class="s2">&quot;http://www.opengis.net/def/crs/OGC/1.3/CRS84&quot;</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>If you open the browser development console, you can observe the HTTP response header:</p>
<p><code>Content-Crs: &lt;http://www.opengis.net/def/crs/EPSG/0/4258&gt;</code></p>
<p>(The CRS URI is always enclosed in <code>&lt;</code> <code>&gt;</code>)</p>
</div></section><section class="print-page" id="advanced-ui-custom-templates" heading-number="6.4"><h1 id="advanced-ui-custom-templates-ui-customization-and-templating">UI customization and templating</h1>
<p>pygeoapi adopted the Jinja2 templating mechanism to style HTML output. Each element visualized on the HTML output is
customizable by overriding the relevant template. Templates are located in the <a href="https://github.com/geopython/pygeoapi/tree/master/pygeoapi/templates"><code>pygeoapi/templates</code></a> folder.
It is possible to override any template by copying it into a separate folder and adjust it to your needs. In the pygeoapi
configuration you can then indicate the path to the override folder. Notice that for files which are not placed
in the override folder, the original file is used.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>For any customization, mind that with a new version of pygeoapi changes on the default templates are not automatically
available on the overriden files. Upgrades need to be carefully tested and validated.</p>
</div>
<h2 id="advanced-ui-custom-templates-jinja2">Jinja2</h2>
<p><a href="https://jinja.palletsprojects.com">Jinja2</a> is a common templating concept in the Python community. With a minimal background
in HTML you will be able to make minor but meaningful customizations. At the core of pygeoapi's template setup is the
<a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/templates/_base.html"><code>_base.html</code></a> template, which defines the
header and footer of the page. The fragment below defines the footer of the page, notice the parameters in curly braces,
which are replaced by dynamic content. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code> <span class="p">&lt;</span><span class="nt">footer</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;sticky&quot;</span><span class="p">&gt;</span>
    {% trans %}Powered by {% endtrans %} 
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;pygeoapi&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://pygeoapi.io&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{ config[&#39;server&#39;][&#39;url&#39;] }}/assets/images/pygeoapi.png&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;pygeoapi logo&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;height:24px;vertical-align: middle;&quot;</span><span class="p">/&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> 
    {{ version }}
<span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<div class="admonition help">
<p class="admonition-title">Customizing an HTML page</p>
<p>Copy <code>_base.html</code> to a separate folder. Adjust some elements on that page (e.g. logo image). Then, include a reference to the new folder in
the pygeoapi configuration. Restart the service. Verify the result.</p>
</div>
<h2 id="advanced-ui-custom-templates-css-customizations">CSS customizations</h2>
<p>From the customized HTML template you can reference a new stylesheet file with customizations or directly add your customizations to <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/static/css/default.css">/static/css/default.css</a>.</p>
<h1 id="advanced-ui-custom-templates-summary">Summary</h1>
<p>Congratulations! You've added a custom look and feel to your pygeoapi deployment.</p></section><section class="print-page" id="advanced-downstream-applications" heading-number="6.5"><h1 id="advanced-downstream-applications-using-pygeoapi-in-downstream-applications">Using pygeoapi in downstream applications</h1>
<p>While pygeoapi is typically run as a standalone application, it is also designed
to enable direct usage via external Python applications in a number of different
design patterns.at multiple levels. From the <a href="https://docs.pygeoapi.io/en/latest/how-pygeoapi-works.html">official documentation</a>, the below
diagram provides an overview of how pygeoapi is designed and architected:</p>
<p><a href="https://docs.pygeoapi.io/en/latest/how-pygeoapi-works.html"><img alt="how pygeoapi works" src="https://docs.pygeoapi.io/en/latest/_images/how-pygeoapi-works.png" /></a></p>
<p>There are two main ways to create a downstream application:</p>
<ul>
<li>Using the core API</li>
<li>Extending through the web interface of the frameworks supported out-of-the box</li>
</ul>
<h2 id="advanced-downstream-applications-using-the-core-api-directly">Using the core API directly</h2>
<p>The core pygeoapi Python API entrypoint is <code>pygeoapi.api.API</code>, which is initialized with the pygeoapi configuration
as a Python <code>dict</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pygeoapi core API enables the developer to manage pygeoapi configuration in any number of ways
(file on disk, object storage, database driven, etc.)</p>
</div>
<p>From here, API objects provide a number of functions, most of which require a <a href="https://docs.pygeoapi.io/en/latest/api-documentation.html#pygeoapi.api.APIRequest"><code>pygeoapi.api.APIRequest</code></a> object
according to the web framework. Examples include:</p>
<ul>
<li><a href="https://flask.palletsprojects.com/en/latest/api/#incoming-request-data">Flask</a></li>
<li><a href="https://www.starlette.io/requests">Starlette</a></li>
<li><a href="https://fastapi.tiangolo.com/advanced/using-request-directly">FastAPI</a></li>
<li><a href="https://docs.djangoproject.com/en/4.1/ref/request-response/#django.http.HttpRequest">Django</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a href="https://docs.pygeoapi.io/en/latest/api-documentation.html#pygeoapi.api.APIRequest">official documentation</a>
for more information about <code>pygeoapi.api.APIRequest</code> (you can even use your own custom request object as long as it
satisfies the interface requirements of <code>pygeoapi.api.APIRequest</code>.</p>
</div>
<p>Let's take a look at what a bare bones API integration would look like, using Flask as an example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">make_response</span><span class="p">,</span> <span class="n">request</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">API</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">yaml_load</span>

<span class="n">my_flask_app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;my-pygeoapi-config.yml&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">my_pygeoapi_config</span> <span class="o">=</span> <span class="n">yaml_load</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>

<span class="n">my_pygeoapi_api</span> <span class="o">=</span> <span class="n">API</span><span class="p">(</span><span class="n">my_pygeoapi_config</span><span class="p">)</span>

<span class="nd">@my_flask_app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/my-landing-page-route&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_def</span><span class="p">():</span>

    <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">my_pygeoapi_api</span><span class="o">.</span><span class="n">landing_page</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">headers</span><span class="p">:</span> 
        <span class="n">response</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a href="https://docs.pygeoapi.io/en/latest/api-documentation.html#module-pygeoapi.api">official documentation</a>
for more information on the core Python API</p>
</div>
<h2 id="advanced-downstream-applications-extending-through-a-web-framework">Extending through a web framework</h2>
<p>pygeoapi can be installed and used at the web routing level as a dependency in your project. This is pretty much the easier way to leverage the flexibility and the modularity of its architecture.
Once the interfaces are available then the developer can use the preferred framework for serving the frontend application. In practice
the following modules:</p>
<ul>
<li><code>pygeoapi.flask_app.py</code> for Flask blueprints</li>
<li><code>pygeoapi.starlette_app.py</code> for Starlette/FastAPI</li>
<li><code>pygeoapi.django_app.py</code> for Django (ongoing <a href="https://github.com/geopython/pygeoapi/pull/630">PR</a>)</li>
</ul>
<p>Some examples are available below for developers.</p>
<h3 id="advanced-downstream-applications-examples">Examples</h3>
<h4 id="advanced-downstream-applications-flask-blueprints">Flask blueprints</h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.flask_app</span><span class="w"> </span><span class="kn">import</span> <span class="n">BLUEPRINT</span> <span class="k">as</span> <span class="n">pygeoapi_blueprint</span>

<span class="n">my_flask_app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">static_url_path</span><span class="o">=</span><span class="s1">&#39;/static&#39;</span><span class="p">)</span>
<span class="n">my_flask_app</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">strict_slashes</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># mount all pygeoapi endpoints to /oapi</span>
<span class="n">my_flask_app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">pygeoapi_blueprint</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s1">&#39;/oapi&#39;</span><span class="p">)</span>


<span class="nd">@my_flask_app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;p&gt;home page&lt;/p&gt;&#39;</span>
</code></pre></div>
<h4 id="advanced-downstream-applications-starlette-and-fastapi">Starlette and FastAPI</h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">uvicorn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastAPI</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastapi.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">RequestValidationError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">starlette.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTTPException</span> <span class="k">as</span> <span class="n">StarletteHTTPException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">starlette.middleware.cors</span><span class="w"> </span><span class="kn">import</span> <span class="n">CORSMiddleware</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoapi.starlette_app</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">pygeoapi_app</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_app</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">FastAPI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle application creation.&quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;my_pygeoapi&quot;</span><span class="p">,</span> <span class="n">root_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Set all CORS enabled origins</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_middleware</span><span class="p">(</span>
        <span class="n">CORSMiddleware</span><span class="p">,</span>
        <span class="n">allow_origins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
        <span class="n">allow_credentials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">allow_methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
        <span class="n">allow_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="nd">@app</span><span class="o">.</span><span class="n">exception_handler</span><span class="p">(</span><span class="n">StarletteHTTPException</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">custom_http_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">http_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="nd">@app</span><span class="o">.</span><span class="n">exception_handler</span><span class="p">(</span><span class="n">RequestValidationError</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">custom_validation_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">request_validation_exception_handler</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="c1"># mount all pygeoapi endpoints to /oapi</span>
    <span class="n">app</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/oapi&quot;</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="n">pygeoapi_app</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">app</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div></section><section class="print-page" id="advanced-seo" heading-number="6.6"><h1 id="advanced-seo-search-engine-optimization-seo">Search Engine Optimization (SEO)</h1>
<p>OGC API - Features adopted the Spatial Data on the Web <a href="https://www.w3.org/TR/sdw-bp/#indexable-by-search-engines">Best Practice 2: Make your spatial data indexable by search engines</a> with the recommendation to <a href="http://docs.ogc.org/is/17-069r3/17-069r3.html#_requirements_class_html">include HTML as an output format of any OGC API</a>. It means that users can navigate an OGC API from within their browser and Search Engines are able to crawl the content.</p>
<p>An aspect to consider is that, since the API becomes a webpage, common practices for web architecture and development become relevant:</p>
<ul>
<li>does the website have a clear navigation?</li>
<li>is a company logo, branding, privacy statement, cookie warning included?</li>
<li>is the webpage <a href="https://www.w3.org/TR/WCAG21">WCAG</a> accessable?</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Notice that the pygeoapi configuration also has an option to disable HTML output. In that scenario, only the JSON output is available.</p>
</div>
<p>On the Web, websites are typically visited by <a href="https://en.wikipedia.org/wiki/Web_crawler">web crawlers</a> of popular search engines. Crawlers
are automated processes which aid in building the index of the search engine. Crawlers follow links on the Web to identify new or updated
content. Cross linking your API to other resources therefore increases the visibility (and ranking) of your API.</p>
<p>The British Geo6 wrote an extensive <a href="https://www.gov.uk/government/publications/search-engine-optimisation-for-publishers-best-practice-guide">best practice on SEO for data publishers</a> which offers a good overview of SEO in the scope of data publications.</p>
<h2 id="advanced-seo-tweaking-web-crawler-behaviour">Tweaking Web Crawler behaviour</h2>
<p>This paragraph introduces you to some mechanisms which facilitate or block web crawlers to index your content.</p>
<p>If you are not interested in having your content indexed by search engines, you can provide a <a href="https://en.wikipedia.org/wiki/Robots_exclusion_standard">robots.txt</a>
file at the root of your website, specifying which folders should not be indexed. More drastically is the option to block access for crawlers or bots to your content
by filtering traffic to the website based on the HTTP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">User-Agent header</a>. Such a rule can
be added to a firewall or web server configuration.</p>
<p>A <code>robots.txt</code> file can also include a link to a <a href="https://en.wikipedia.org/wiki/Sitemaps">Sitemap</a>. Many search engines provide the option to submit a sitemap
in order to speed up crawling and indexing. pygeoapi does not provide a sitemap of its content, but you can create your own sitemap (publish as <code>/sitemap.xml</code>),
specifying URLs of your desired content to be indexed.</p>
<p>Search engines provide tooling to evaluate the search behaviour of your website. These tools can provide valuable insight in the findability of your website
and content (e.g. keywords used to locate your website).</p>
<h2 id="advanced-seo-schemaorgdataset">Schema.org/Dataset</h2>
<p>Search engines cooperate in the <a href="https://schema.org">Schema.org</a> initiative. Schema.org enables you to annotate your website using the <code>schema.org</code> vocabulaire, in
order for search engines to index the content in a structured manner. Google was the first to employ these annotations to provide a <a href="https://datasetsearch.research.google.com/">dedicated search engine for datasets</a>. pygeoapi adds <code>schema.org/Dataset</code> annotations to collection pages, so collections are automagically included in Google's dataset search.</p>
<div class="admonition question">
<p class="admonition-title">Evaluate the schema.org annotations in collections</p>
<p>Google provides a <a href="https://search.google.com/test/rich-results">tool</a> to evaluate <code>Schema.org</code> annotation in websites. Try evaluating a collection endpoint of pygeoapi
in the tool. If you run pygeoapi locally (not accessible to google), you can copy the source of a page as HTML into the <code>&lt;code&gt;</code> tab, otherwise you can paste the URL of the page in the <code>URL</code> tab.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A similar tool is made available by <a href="https://webmaster.yandex.com/tools/microtest">Yandex</a> (note that registration is required).</p>
</div></section><section class="print-page" id="advanced-security-access-control" heading-number="6.7"><h1 id="advanced-security-access-control-security-and-access-control">Security and access control</h1>
<h2 id="advanced-security-access-control-overview">Overview</h2>
<p>Security in general is a broad and complex topic, affecting the entire development lifecycle.
It is recommended to follow security best practices during all development phases like design, coding and deployment.
In this workshop we will focus only on API security and access control, rather than the full range of application security topics.</p>
<h2 id="advanced-security-access-control-api-security">API security</h2>
<p>API security is the whole process to protect APIs from attacks. It is part of the more general security guidelines that are being treated in the OWASP Top Ten document. So those recommendations still apply.</p>
<div class="admonition note">
<p class="admonition-title">Application Security</p>
<p>The Open Web Application Security Project (OWASP) <a href="https://owasp.org/www-project-top-ten/">Top Ten document</a> is a very good tool to ensure the bare minimum against the security risks and manage critical treats that are most likely affecting your code.</p>
</div>
<h2 id="advanced-security-access-control-access-control">Access control</h2>
<p>Access control is another fundamental part of the Open Web Application Security Project and addresses the Identity and Access Management (IAM) of an API.
IAM consists of two different parts of a security flow:</p>
<ul>
<li><em>Authentication</em> (AuthN) verifies the user's identity in order to allow or deny subsequent access (see next)</li>
<li><em>Authorization</em> (AuthZ) validates permissions of a user (identity) to access a resource. The permissions of that identity are checked against a resource's policies to (dis)allow access to, for example, (parts of) an API.</li>
</ul>
<p>These parts are usually managed by dedicated infrastructures and solutions which usually provide most of the security requirements out-of-the-box.</p>
<div class="admonition note">
<p class="admonition-title">OpenAPI Security Specification</p>
<p>The OpenAPI specification has very well-defined elements for developers and adopters. The most relevant are:</p>
<ul>
<li><a href="https://swagger.io/specification/#security-scheme-object">Security Scheme Object</a> defines the security schemes that can be used by the operations. Supported schemes are <em>HTTP Authentication</em>, an <em>API Key</em>, <em>OAuth2</em>'s flows and <em>OpenID Connect</em>.</li>
<li><a href="https://swagger.io/specification/#security-requirement-object">Security Requirement Object</a> defines the list of required security schemes to execute an operation.</li>
</ul>
</div>
<h2 id="advanced-security-access-control-pygeoapi-considerations">pygeoapi considerations</h2>
<p>pygeoapi does not yet support OpenAPI security elements.  Future implementation could include generation of pygeoapi's OpenAPI document with a security configuration, or to generate from a known access control solution/application (such as <a href="https://github.com/geobeyond/fastgeoapi">fastgeoapi</a> or <a href="https://github.com/cartologic/pygeoapi-auth">pygeoapi-auth</a>).</p>
<p>Direct access control implementation is not in scope for pygeoapi.  The desired approach here would be to leverage an existing solution and define/integrate the secured endpoints accordingly.  For example, fastgeoapi or pygeoapi-auth could be deployed downstream of pygeoapi, and govern access to specific endpoints (collections, items, etc.).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a href="https://docs.pygeoapi.io/en/latest/security.html">pygeoapi official documentation</a> provides the project's official status on security implementation updates, and should be visited to keep up to date with the latest status on security implementation in the project.</p>
</div></section><section class="print-page" id="advanced-semantic-web-linked-data" heading-number="6.8"><h1 id="advanced-semantic-web-linked-data-semantic-web-and-linked-data">Semantic Web and Linked Data</h1>
<p>This section touches on 3 aspects of the Semantic Web:</p>
<ul>
<li><a href="#advanced-semantic-web-linked-data-search-engines">Search engines</a></li>
<li><a href="#advanced-semantic-web-linked-data-publish-spatial-data-in-the-semantic-web">Publish spatial data in the semantic web</a></li>
<li><a href="#advanced-semantic-web-linked-data-proxy-to-the-semantic-web">Proxy to semantic web</a></li>
</ul>
<h2 id="advanced-semantic-web-linked-data-search-engines">Search engines</h2>
<p>Search engines use technology similar to the Semantic Web to facilitate capturing structured data (aka rich snippets) from web pages.
pygeoapi supports this use case via embedding a <code>schema.org</code> JSON-LD snippet in the HTML encoding,</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code>schema.org</code> ontology is not a formal Semantic Web ontology, it is therefore a bit disconnected from the rest of the Semantic Web</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See more information at <a href="#advanced-seo">Search Engine Optimization</a></p>
</div>
<h2 id="advanced-semantic-web-linked-data-publish-spatial-data-in-the-semantic-web">Publish spatial data in the Semantic Web</h2>
<p>OGC API - Common adopted a number of W3C conventions, which bring OGC APIs closer to the standards of Semantic Web,
compared to first generation OGC Web Service (OWS) standards.</p>
<p>Currently, pygeaopi does not aim to be a full implementation of Semantic Web, however it is possible to advertise
some aspects of the Semantic Web so the data can be traversed by Semantic Web aware clients.</p>
<div class="admonition question">
<p class="admonition-title">Use a SPARQL client to query pygeoapi</p>
<p><a href="https://en.wikipedia.org/wiki/SPARQL">SPARQL</a> is commonly known as the query language to query triple stores. 
However you can also use SPARQL to query graphs of linked web resources. The SPARQL client traverses links between 
the resources to locate the requested triples. <a href="https://jena.apache.org/documentation/query/">Jena ARQ</a> is a command 
line SPARQL client which is able to run such queries. Jena is quite difficult to set up, although there is a 
<a href="https://hub.docker.com/r/stain/jena">Docker image</a> available. As an alternative we will use a web-based implementation 
of the ARQ engine. Navigate to <a href="https://demos.isl.ics.forth.gr/sparql-ld-endpoint/">https://demos.isl.ics.forth.gr/sparql-ld-endpoint</a>
and replace the query in the textbox with:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">SERVICE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">demo</span><span class="p">.</span><span class="n">pygeoapi</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">collections</span><span class="o">/</span><span class="n">lakes</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">    </span><span class="err">{</span><span class="w"> </span>
<span class="w">    </span><span class="o">?</span><span class="n">s</span><span class="w"> </span><span class="o">?</span><span class="n">p</span><span class="w"> </span><span class="o">?</span><span class="n">o</span><span class="w">  </span>
<span class="w">    </span><span class="err">}</span><span class="w"> </span>
<span class="w">  </span><span class="err">}</span><span class="w"> </span>
<span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>A query to an item returns the item with its geometry:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">SERVICE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">demo</span><span class="p">.</span><span class="n">pygeoapi</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">collections</span><span class="o">/</span><span class="n">lakes</span><span class="o">/</span><span class="n">items</span><span class="o">/</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="err">{{</span><span class="w"> </span><span class="o">?</span><span class="n">s</span><span class="w"> </span><span class="o">?</span><span class="n">p</span><span class="w"> </span><span class="o">?</span><span class="n">o</span><span class="w"> </span><span class="err">}}</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>Notice that the SPARQL client fails if you hardcode the HTML format. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">SERVICE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">demo</span><span class="p">.</span><span class="n">pygeoapi</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">collections</span><span class="o">/</span><span class="n">lakes</span><span class="o">?</span><span class="n">f</span><span class="o">=</span><span class="n">html</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="err">{</span><span class="w"> </span><span class="o">?</span><span class="n">s</span><span class="w"> </span><span class="o">?</span><span class="n">p</span><span class="w"> </span><span class="o">?</span><span class="n">o</span><span class="w"> </span><span class="err">}</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>JSON-LD as expected by search engines has some challenges for semantic web tools. So how does it work if the format is not hardcoded? 
The SPARQL engine <strong>negotiates</strong> with the endpoint to evaluate which (RDF) encodings are available, and based on the content negotiation 
it requests the <code>JSON_LD</code> encoding via <code>f=jsonld</code>.</p>
</div>
<p>pygeoapi adopted conventions of the <a href="https://json-ld.org">JSON-LD</a> community to annotate JSON as RDF. For features, each property (column in a source table) 
is annotated by a semantic concept. The related configuration to apply the annotations is managed in the context element of a resource definition</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Read more in the <a href="https://docs.pygeoapi.io/configuration#Linked_data">pygeoapi documentation</a>.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">context</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">schema</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://schema.org/</span>
<span class="w">    </span><span class="nt">stn_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:identifer</span>
<span class="w">    </span><span class="nt">datetime</span><span class="p">:</span>
<span class="w">        </span><span class="s">&quot;@id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:observationDate</span>
<span class="w">        </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:DateTime</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="s">&quot;@id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:value</span>
<span class="w">        </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">schema:Number</span>
</code></pre></div></td></tr></table></div>
<h2 id="advanced-semantic-web-linked-data-proxy-to-the-semantic-web">Proxy to the Semantic Web</h2>
<p>Spatial data engineers are generally challenged when importing and visualizing fragments of the semantic web. The number of spatial 
<a href="https://plugins.qgis.org/plugins/sparqlunicorn">clients currently supporting SQARQL</a> interaction is limited and requires expert knowledge to use. 
A group within the pygeoapi community aims to facilitate semantic web access for spatial data engineers by introducing pygeoapi as a proxy 
between the typical GIS clients and the semantic web.</p>
<p>A <a href="https://github.com/geopython/pygeoapi/pull/615">new feature</a> is being prepared which introduces a SPARQL provider to pygeoapi. 
The provider enables to browse the results of a SPARQL query as an OGC API - Features collection.</p>
<h1 id="advanced-semantic-web-linked-data-summary">Summary</h1>
<p>Congratulations! You can now configure pygeoapi configurations with linked data concepts.</p></section><section class="print-page" id="advanced-cloud" heading-number="6.9"><h1 id="advanced-cloud-cloud-deployment">Cloud deployment</h1>
<p>Deployment to cloud infratructure and concepts such as Microservices and <a href="https://12factor.net">Twelve-Factor</a> present specific requirements to
how software is designed and implemented. pygeoapi supports these concepts, having a low footprint on CPU and memory, and does not persist user
state, therefore being able to scale without risks.</p>
<h2 id="advanced-cloud-pygeoapi-and-docker">pygeoapi and Docker</h2>
<p>A <a href="https://hub.docker.com/r/geopython/pygeoapi">Docker image</a> is available for pygeoapi. You can run the image locally as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="advanced-cloud-__tabbed_1_1" name="advanced-cloud-__tabbed_1" type="radio" /><input id="advanced-cloud-__tabbed_1_2" name="advanced-cloud-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="advanced-cloud-__tabbed_1_1">Linux/Mac</label><label for="advanced-cloud-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
<div class="admonition question">
<p class="admonition-title">Review the pygeoapi Dockerfile</p>
<p>Notice in the <a href="https://github.com/geopython/pygeoapi/Dockerfile">pygeoapi Dockerfile</a> how the open api file is generated as part of the Docker startup script. </p>
</div>
<p>In a typical configuration one would override the default pygeoapi configuration file in the image with a customized one and include the data folder:</p>
<div class="admonition example">
<p class="admonition-title">using custom configuration</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="advanced-cloud-__tabbed_2_1" name="advanced-cloud-__tabbed_2" type="radio" /><input id="advanced-cloud-__tabbed_2_2" name="advanced-cloud-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="advanced-cloud-__tabbed_2_1">Linux/Mac</label><label for="advanced-cloud-__tabbed_2_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span><span class="se">\ </span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/pygeoapi-config.yml:/pygeoapi/local.config.yml<span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/geodata:/geodata<span class="w"> </span>https://hub.docker.com/r/geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/pygeoapi-config.yml:/pygeoapi/local.config.yml<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/geodata:/geodata<span class="w"> </span>https://hub.docker.com/r/geopython/pygeoapi:latest
</code></pre></div>
</div></p>
</div>
</div>
</div>
</div>
<p>Alternatively, you can build a fresh Docker image including both the configuration and data for the service. </p>
<div class="highlight"><pre><span></span><code>FROM geopython/pygeoapi:latest
COPY ./my.config.yml /pygeoapi/local.config.yml
</code></pre></div>
<p>You may have noticed that the pygeoapi configuration file includes a reference to the endpoint on which pygeoapi is published. This configuration should
match the public endpoint of the service (domain, path and port).</p>
<p>By default the pygeoapi Docker image will run from the <code>root</code> path <code>/</code>. If you need to run from a sub-path and have all internal URLs correct you can
set the <code>SCRIPT_NAME</code> environment variable.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="advanced-cloud-__tabbed_3_1" name="advanced-cloud-__tabbed_3" type="radio" /><input id="advanced-cloud-__tabbed_3_2" name="advanced-cloud-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="advanced-cloud-__tabbed_3_1">Linux/Mac</label><label for="advanced-cloud-__tabbed_3_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-e<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span><span class="s1">&#39;/mypygeoapi&#39;</span><span class="w"> </span><span class="se">\</span>
-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/my.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>-it<span class="w"> </span>geopython/pygeoapi
<span class="c1"># browse to http://localhost:5000/mypygeoapi</span>
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:80<span class="w"> </span>-e<span class="w"> </span><span class="nv">SCRIPT_NAME</span><span class="o">=</span><span class="s1">&#39;/mypygeoapi&#39;</span><span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>/my.config.yml:/pygeoapi/local.config.yml<span class="w"> </span>-it<span class="w"> </span>geopython/pygeoapi
<span class="c1"># browse to http://localhost:5000/mypygeoapi</span>
</code></pre></div>
</div></p>
</div>
</div>
</div>
<h1 id="advanced-cloud-summary">Summary</h1>
<p>Congratulations! You can now deploy pygeopi as a cloud native service.</p></section><section class="print-page" id="advanced-inspire" heading-number="6.10"><h1 id="advanced-inspire-inspire-support">INSPIRE support</h1>
<p><a href="https://inspire.ec.europa.eu">INSPIRE</a> is a European directive on data sharing in the environmental domain. EU member states 
have invested almost 20 years of effort to harmonize data in the environmental domain and publish it using OGC standards. 
The directive is at the end of its lifetime, but the expectation is that conventions from the INSPIRE directive will be adopted 
by upcoming directives, such as green deal and open data directives. </p>
<p>In the past 20 years, the IT landscape has changed considerably. INSPIRE has followed these developments by adopting a 
series of <a href="https://inspire.ec.europa.eu/portfolio/good-practice-library">Good Practices</a> which supersede the original 
<a href="https://inspire.ec.europa.eu/Technical-guidelines3">Technical Guidelines</a>.</p>
<p>Some of the recent and upcoming good practices focus on the developments in the OGC API domain. 
One good practice has already been adopted on providing 
<a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features">download services using OGC API - Features</a> 
and others are in preparation, such as the 
<a href="https://github.com/INSPIRE-MIF/gp-ogc-api-records">discovery service using OGC API - Records</a>. 
These developments make pygeoapi an interesting option 
for providing INSPIRE services.</p>
<h2 id="advanced-inspire-inspire-services-and-their-ogc-api-alternative">INSPIRE services and their OGC API alternative</h2>
<p>INSPIRE services are typically categorized in view services, download services and discovery services. 
Download services are further devided in Vector sources, Coverage sources and Sensor sources.
The OGC API initiative provides the related APIs for each service.
The table below highlights for each service type the Technical Guidenace
recommendation and the relevant Good Practices. </p>
<table>
<thead>
<tr>
<th>Service type</th>
<th>TG</th>
<th>OGC API</th>
<th>Good practice status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Discovery service</td>
<td>CSW</td>
<td>OGC API - Records</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-records">In preparation</a></td>
</tr>
<tr>
<td>View service</td>
<td>WM(T)S</td>
<td>OGC API - Maps / OGC API - Tiles</td>
<td>Not scheduled<br> <a href="https://wikis.ec.europa.eu/display/InspireMIG/69th+MIG-T+meeting+2022-04-01">In preparation</a></td>
</tr>
<tr>
<td>Download service - Vector</td>
<td>WFS</td>
<td>OGC API - Features</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features">Adopted</a></td>
</tr>
<tr>
<td>Download service - Coverage</td>
<td>WCS</td>
<td>OGC API - Coverages / STAC <sup id="fnref:1"><a class="footnote-ref" href="#advanced-inspire-fn:1">1</a></sup></td>
<td>Not scheduled<br> <a href="https://github.com/INSPIRE-MIF/gp-stac">In preparation</a></td>
</tr>
<tr>
<td>Download service - Sensor</td>
<td>SOS</td>
<td>OGC API - EDR / Sensorthings API <sup id="fnref:2"><a class="footnote-ref" href="#advanced-inspire-fn:2">2</a></sup></td>
<td>Not scheduled<br> <a href="https://github.com/INSPIRE-MIF/gp-ogc-sensorthings-api">Adopted</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When adopting Good Practices, consider that the documentation and tools for validation are still limited. 
Also the INSPIRE GeoPortal may not be ready to harvest records from an OGC API - Records endpoint yet. </p>
</div>
<div class="admonition question">
<p class="admonition-title">Publish metadata documents as an INSPIRE discovery service</p>
<p>In this exercise we will import a folder of metadata documents into a TinyDB database and configure the database as an OGC API - Records endpoint. 
Download the zipfile 'inspire-records.zip' from the repository. Expand the zipfile. The <code>/tests</code> folder contains a script 
<a href="https://github.com/geopython/pygeoapi/blob/master/tests/load_tinydb_records.py">load_tinydb_records.py</a>. The script has 2 parameters:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="advanced-inspire-__tabbed_1_1" name="advanced-inspire-__tabbed_1" type="radio" /><input id="advanced-inspire-__tabbed_1_2" name="advanced-inspire-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="advanced-inspire-__tabbed_1_1">Linux/Mac</label><label for="advanced-inspire-__tabbed_1_2">Windows (PowerShell)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>&lt;path/to/xml-files&gt;<span class="w"> </span>&lt;output.db&gt;
</code></pre></div>
</div></p>
</div>
<div class="tabbed-block">
<p><div class="termy">
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>load_tinydb_records.py<span class="w"> </span>&lt;path/to/xml-files&gt;<span class="w"> </span>&lt;output.db&gt;
</code></pre></div>
</div></p>
</div>
</div>
</div>
<p>Now configure <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-records.html#tinydbcatalogue">TinyDB as a provider for OGC API - Records</a>. Restart the service and verify the result. Verify also the XML output of some of the records. </p>
</div>
<h2 id="advanced-inspire-ogc-api-and-the-inspire-data-models">OGC API and the INSPIRE data models</h2>
<p>Most of the INSPIRE data models have a hierarchical structure, which is not common in the GeoJSON oriented OGC API community. 
In theory it is possible to provide hierarchical GML from an OGC API endpoint, but there are not many experiences yet currently.
Two initiatives may bring improvement to this aspect:</p>
<ul>
<li>pygeoapi facilitates to configure a JSON-LD encoding using an arbitrary ontology. The 
<a href="https://inspire-eu-rdf.github.io/inspire-rdf-guidelines">good practice on semantic web</a> provides some of the data models
in an RDF ontology</li>
<li>The <a href="https://github.com/INSPIRE-MIF/gp-geopackage-encodings">good practice on alternative encodings</a> suggests an 
approach to publish datasets using a relational data model such as GeoPackage, which fits better with the OGC API community</li>
</ul>
<h2 id="advanced-inspire-ogc-api-as-a-codelist-registry">OGC API as a codelist registry</h2>
<p>A typical use case in INSPIRE is the option to extend an INSPIRE codelist to match a local requirement. For this use case the 
extended codelist has to be published in a registry. OGC API - Common provides mechanisms to publish lists of concepts as items 
in collections. pygeoapi also provides a mechanism to advertise the concepts using the SKOS ontology via its JSON-LD 
encoding. In the coincidence that a concept has a geometry property, the codelist can even be published as OGC API - Features 
(on a map).</p>
<div class="admonition question">
<p class="admonition-title">Publish a codelist via OGC API</p>
<p>A German Soiltype codelist has been made available in CSV format in <code>workshop/exercises/data/bodenart.en.csv</code>. Use the <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#csv">CSV provider</a> to publish this dataset in pygeoapi. Which URL would you use to reference a concept in the published list?</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">SoilTypes</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Soil types of Germany</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bodenarten auf Basis der Bodenkundlichen Kartieranleitung 5. Auflage (KA5)</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">soiltype</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Soil types of Germany</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://registry.gdi-de.org/codelist/de.bund.thuenen/bodenart</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">de</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CSV</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/data/bodenart.en.csv</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Label</span>
<span class="w">          </span><span class="nt">geometry</span><span class="p">:</span>
<span class="w">              </span><span class="nt">x_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">              </span><span class="nt">y_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">y</span>
</code></pre></div></td></tr></table></div>
<h1 id="advanced-inspire-summary">Summary</h1>
<p>Congratulations! You have worked with pygeoapi for INSPIRE compliance</p>
<div class="footnote">
<hr />
<ol>
<li id="advanced-inspire-fn:1">
<p>Sensorthings API and is not an OGC API standards and is currently not supported by pygeoapi. It is listed here for completeness&#160;<a class="footnote-backref" href="#advanced-inspire-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="advanced-inspire-fn:2">
<p>STAC is not OGC API standard but is supported by pygeoapi&#160;<a class="footnote-backref" href="#advanced-inspire-fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="advanced-administration" heading-number="6.11"><h1 id="advanced-administration-administration">Administration</h1>
<h2 id="advanced-administration-overview">Overview</h2>
<p>pygeoapi provides an administration API (see the pygeoapi <a href="https://docs.pygeoapi.io/en/latest/admin-api.html">documentation</a> for more information on how to enable, configure and use) in support of managing its configuration.  The API (not an OGC API) is implementated as a RESTful service to help create, update, replace or delete various elements of pygeoapi configuration.  A simple read-only UI is implemented as part of the admin API.</p>
<h2 id="advanced-administration-user-interface">User interface</h2>
<p>By design, pygeoapi does not provide a true user interface to administer the configuration.  Given that the admin API exists, a few options can be considered for developing an admin UI:</p>
<ul>
<li>standalone<ul>
<li>simple application with no connectivity to the pygeoapi admin API</li>
<li>built off the pygeoapi configuration <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/schemas/config/pygeoapi-config-0.x.yml">schema</a></li>
<li>allows for paste of existing pygeoapi configuration</li>
<li>allows for generating pygeoapi configuration for copy/paste into a pygeoapi deployment</li>
<li>can be deployed anywhere (for example, GitHub Pages)</li>
</ul>
</li>
<li>integrated<ul>
<li>connected application to a pygeoapi deployment</li>
<li>built off the pygeoapi configuration <a href="https://github.com/geopython/pygeoapi/blob/master/pygeoapi/schemas/config/pygeoapi-config-0.x.yml">schema</a></li>
<li>reads/writes a live pygeoapi configuration via the pygeoapi admin API (access controlled)</li>
<li>deployed as part of a Docker Compose application</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Have your own idea for a pygeoapi admin UI?  Connect with the <a href="https://pygeoapi.io/community">pygeoapi community</a> to discuss your idea!</p>
</div></section><section class="print-page" id="advanced-bridges" heading-number="6.12"><h1 id="advanced-bridges-exercise-9-pygeoapi-as-a-bridge-to-other-services">Exercise 9 - pygeoapi as a bridge to other services</h1>
<p>In this section we explore how pygeoapi can be used as a facade, or a bridge, to re-publish web services with different interfaces. These bridges can help <a href="https://ogcapi-workshop.ogc.org/transition-and-migration">organisations migrating from OWS to OGC API</a>.</p>
<h2 id="advanced-bridges-publishing-wfs-as-ogc-api-features">Publishing WFS as OGC API - Features</h2>
<p>A powerful use case for pygeoapi is to provide an OGC API - Features interface over existing Web Feature Service (WFS) 
or ESRI FeatureServer endpoints. In this scenario, you lower the barrier and increase the usability of existing services to 
a wider audience. Let's set up an API on top of an existing WFS hosted by the city of Florence.</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration in a text editor. 
Find the line <code># START - EXERCISE 8 - WFS Proxy</code>.</p>
<p>Add a new dataset section by uncommenting the lines up to <code># END - EXERCISE 8 - WFS Proxy</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">suol_epicentri_storici</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Epicenters of the main historical earthquakes</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Location of the epicenters of the main historical earthquakes in the territory of the Metropolitan City of Florence classified by year and intensity</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">earthquakes</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/xml</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Epicenters of the main historical earthquakes</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://pubblicazioni.cittametropolitana.fi.it/geoserver/territorio/wfs?request=getCapabilities&amp;service=WFS&amp;version=2.0.0</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">it</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10.94</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">43.52</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">11.65</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">44.17</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OGR</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span>
<span class="w">              </span><span class="nt">source_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WFS</span>
<span class="w">              </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WFS:http://pubblicazioni.cittametropolitana.fi.it/geoserver/territorio/wfs?</span>
<span class="w">              </span><span class="nt">source_capabilities</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">paging</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">              </span><span class="nt">source_options</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">OGR_WFS_LOAD_MULTIPLE_LAYER_DEFN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="w">              </span><span class="nt">gdal_ogr_options</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">EMPTY_AS_NULL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="w">                  </span><span class="nt">GDAL_CACHEMAX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">                  </span><span class="nt">CPL_DEBUG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cpti_id</span>
<span class="w">          </span><span class="nt">crs</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/4258</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3857</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3003</span>
<span class="w">          </span><span class="nt">storage_crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/EPSG/0/3003</span>
<span class="w">          </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d</span>
<span class="w">          </span><span class="nt">layer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">territorio:suol_epicentri_storici</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Save the file and restart Docker Compose. Navigate to <a href="http://localhost:5000/collections">http://localhost:5000/collections</a>
to evaluate whether the new dataset has been published.</p>
<p>Note these important configuration slices under <code>providers</code>:</p>
<ul>
<li>
<p>We use the pygeoapi <a href="https://docs.pygeoapi.io/en/latest/data-publishing/ogcapi-features.html#ogr">OGR Provider</a>. 
This is the most versatile backend of pygeoapi for supporting numerous formats. Using the GDAL/OGR library (Python bindings) allows pygeoapi to connect to <a href="https://gdal.org/drivers/vector">around 80+ Vector Formats</a>.
We could have used the <code>OGR</code> Provider instead of the <code>SQLiteGPKG</code> Provider above in the <code>osm_places-vec</code> exercise above.</p>
</li>
<li>
<p><code>storage_crs</code> denotes the CRS (Coordinate Reference System) in which the dataset is stored (default is CRS84, i.e. 'longitude, latitude') </p>
</li>
<li><code>crs</code> is an array of CRSs that can be specified for the Features to be returned (<code>crs=</code> parameter), or for their bounding box (<code>bbox-crs=</code> parameter). Default is also CRS84.</li>
</ul>
<p>CRS support effectively allows pygeoapi to <em>reproject</em> the data from its storage CRS (here EPSG:3003)
according to <a href="https://docs.opengeospatial.org/is/18-058r1/18-058r1.html">OGC API - Features - Part 2: Coordinate Reference Systems by Reference</a>.
The Advanced section of this workshop will further <a href="#advanced-crs">elaborate pygeoapi CRS support</a>.</p>
<h2 id="advanced-bridges-publishing-wms-as-ogc-api-maps">Publishing WMS as OGC API - Maps</h2>
<p>We can use the pygeoapi's WMSFacade provider to publish OGC Web Map Service (WMS) interfaces as OGC API - Maps.</p>
<p>Let's set up an API on top of an existing WMS on the MapServer Demonstration Server:</p>
<p><a href="https://demo.mapserver.org/cgi-bin/msautotest">https://demo.mapserver.org/cgi-bin/msautotest</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Feel free to use an WMS of your choice, as you wish!</p>
</div>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration in a text editor. 
Find the line <code>## START - EXERCISE 8 - WMS Proxy</code>.</p>
<p>Add a new dataset section by uncommenting the lines up to <code>## END - EXERCISE 8 - WMS Proxy</code>:</p>
<p>Be sure to keep the proper YAML indentation.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">wms-facade-demo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WMS Facade demo</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WMS Facade demo</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WMS facade</span>
<span class="w">    </span><span class="nt">links</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">          </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">          </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MapServer</span>
<span class="w">          </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://mapserver.org</span>
<span class="w">          </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WMSFacade</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://demo.mapserver.org/cgi-bin/msautotest</span>
<span class="w">          </span><span class="nt">options</span><span class="p">:</span>
<span class="w">              </span><span class="nt">layer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">world_latlong</span>
<span class="w">              </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">png</span>
<span class="w">              </span><span class="nt">mimetype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image/png</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Run the following requests in your web browser:</p>
<ul>
<li>default map: <a href="http://localhost:5000/collections/wms-facade-demo/map?f=png">http://localhost:5000/collections/wms-facade-demo/map?f=png</a></li>
<li>specific width/height: <a href="http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600">http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600</a></li>
<li>specific area of interest (bbox of Canada): <a href="http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600&amp;bbox=-142,42,-52,84">http://localhost:5000/collections/wms-facade-demo/map?f=png&amp;width=800&amp;height=600&amp;bbox=-142,42,-52,84</a></li>
</ul>
<p><img alt="" src="../assets/images/maps-response.png" width="80%" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Try with your own bbox and width/height values!</p>
</div>
<h2 id="advanced-bridges-publishing-csw-as-ogc-api-records">Publishing CSW as OGC API - Records</h2>
<p>In this section we'll have a look at how to publish Catalogue Service for the Web (CSW) as OGC API - Records. For that, we will use the <a href="https://demo.pycsw.org/cite/">pycsw OGC CITE demo</a> CSW service.</p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration in a text editor. 
Find the line <code># START - EXERCISE 8 - CSW Proxy</code>.</p>
<p>Add a new dataset section by uncommenting the lines up to <code># END - EXERCISE 8 - CSW Proxy</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">cite_demo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pycsw OGC CITE demo and Reference Implementation</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pycsw is an OARec and OGC CSW server implementation written in Python. pycsw fully implements the OGC API - Records and OpenGIS Catalogue Service Implementation Specification (Catalogue Service for the Web). Initial development started in 2010 (more formally announced in 2011). The project is certified OGC Compliant, and is an OGC Reference Implementation. Since 2015, pycsw is an official OSGeo Project. pycsw allows for the publishing and discovery of geospatial metadata via numerous APIs (CSW 2/CSW 3, OpenSearch, OAI-PMH, SRU). Existing repositories of geospatial metadata can also be exposed, providing a standards-based metadata and catalogue component of spatial data infrastructures. pycsw is Open Source, released under an MIT license, and runs on all major platforms (Windows, Linux, Mac OS X)</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ogc</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cite</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compliance</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">interoperability</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">record</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CSWFacade</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://demo.pycsw.org/cite/csw</span>
<span class="w">          </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">identifier</span>
<span class="w">          </span><span class="nt">time_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">datetime</span>
<span class="w">          </span><span class="nt">title_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">title</span>
</code></pre></div></td></tr></table></div>
</div>
<p>You can explore the proxied catalogue collection using this endpoints:</p>
<ul>
<li>collection metadata page: <a href="http://localhost:5000/collections/cite_demo">http://localhost:5000/collections/cite_demo</a></li>
<li>list of records: <a href="http://localhost:5000/collections/cite_demo/items">http://localhost:5000/collections/cite_demo/items</a></li>
<li>record: <a href="http://localhost:5000/collections/cite_demo/items/urn:uuid:19887a8a-f6b0-4a63-ae56-7fba0e17801f">http://localhost:5000/collections/cite_demo/items/urn:uuid:19887a8a-f6b0-4a63-ae56-7fba0e17801f</a></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remember that you can use the QGIS client suggested <a href="https://dive.pygeoapi.io/publishing/ogcapi-records/#client-access">here</a> to explore this API.</p>
</div>
<h2 id="advanced-bridges-publishing-sensorthings-api-as-ogc-api-features">Publishing SensorThings API as OGC API - Features</h2>
<p>The <a href="https://ogcapi-workshop.ogc.org/api-deep-dive/sensorthings/">OGC SensorThings API standard</a> offers RESTfull interfaces to interconnect IoT devices, data, in an open and unified way. Although there are some clients that support this standard, there are many more that support OGC API - Features.</p>
<p>The pygeoapi SensorThings bridge enables to proxy the SensorThings entities (e.g.:  <code>Thing</code> , <code>Sensor</code>, <code>DataStream</code>, <code>ObservedProperty</code> ) into feature collections.</p>
<p>In this section we'll have a look at how to Publish a SensorThings API <code>Thing</code> as an OGC API - Features collection, which can then be consumed by various clients, like <a href="#publishing-ogcapi-features-client-access">the ones listed here</a></p>
<div class="admonition question">
<p class="admonition-title">Update the pygeoapi configuration</p>
<p>Open the pygeoapi configuration in a text editor. 
Find the line <code># START - EXERCISE 8 - SensorThings Proxy</code>.</p>
<p>Add a new dataset section by uncommenting the lines up to <code># END - EXERCISE 8 - SensorThings Proxy</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">toronto_bikes</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Toronto Bikes SensorThings</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The geographic location with coordinates for the Toronto bike share station</span>
<span class="w">    </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sediments</span>
<span class="w">    </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">        </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">            </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">crs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://www.opengis.net/def/crs/OGC/1.3/CRS84</span>
<span class="w">    </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SensorThings</span>
<span class="w">          </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://toronto-bike-snapshot.sensorup.com/v1.0/</span>
<span class="w">          </span><span class="nt">entity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Things</span>
</code></pre></div></td></tr></table></div>
</div></section></section><section class="print-page" id="conclusion" heading-number="7"><h1 id="conclusion-conclusion">Conclusion</h1>
<p>We hope this workshop provided a valuable overview of the many features of pygeoapi. The project's
goal is enabling low barrier, simple and flexible data publishing, using the OGC API suite of standards.</p>
<p><a href="https://pygeoapi.io"><img alt="pygeoapi logo" src="../assets/images/pygeoapi-logo.png" width="40%" /></a></p>
<p><a href="https://ogcapi.ogc.org"><img alt="OGC APIs banner" src="../assets/images/OGC_APIs_banner.jpg" width="40%" /></a></p>
<h1 id="conclusion-foss4g-europe-2025">FOSS4G Europe 2025</h1>
<p>For those in attendance at <a href="https://2025.europe.foss4g.org">FOSS4G Europe 2025</a>:</p>
<ul>
<li>come to the <a href="https://talks.osgeo.org/foss4g-europe-2025/talk/EPWGP7">pygeoapi project status</a> presentation on Wednesday 16 July 17:45, in room EL11 (Geosolutions)</li>
<li>or the other talks related to pygeoapi:</li>
<li>the pygeoapi team will be at the <a href="https://2025.europe.foss4g.org/schedule/community-sprint/">Community Sprint</a> on 19-20 July, at the conference venue, Faculty of Humanities and Social Sciences (building P)</li>
</ul>
<h1 id="conclusion-contributing">Contributing</h1>
<p>Suggestions, improvements and fixes are always welcome. Please visit our <a href="https://pygeoapi.io/community">community</a>
page for more information on getting in touch.</p>
<p>Thank you for your interest in pygeoapi!</p></section></div><style>.print-site-enumerate-headings #index > h1:before { content: '1 ' }

                .print-site-enumerate-headings #index h2:before { content: '1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-reset: counter-index-3 ;  counter-increment: counter-index-2 }
            
                .print-site-enumerate-headings #index h3:before { content: '1.' counter(counter-index-2) '.' counter(counter-index-3) ' ' }
                .print-site-enumerate-headings #index h3 {  counter-increment: counter-index-3 }
            
.print-site-enumerate-headings #introduction > h1:before { content: '2 ' }

                .print-site-enumerate-headings #introduction h2:before { content: '2.' counter(counter-introduction-2) ' ' }
                .print-site-enumerate-headings #introduction h2 {  counter-reset: counter-introduction-3 ;  counter-increment: counter-introduction-2 }
            
                .print-site-enumerate-headings #introduction h3:before { content: '2.' counter(counter-introduction-2) '.' counter(counter-introduction-3) ' ' }
                .print-site-enumerate-headings #introduction h3 {  counter-increment: counter-introduction-3 }
            
.print-site-enumerate-headings #setup > h1:before { content: '3 ' }

                .print-site-enumerate-headings #setup h2:before { content: '3.' counter(counter-setup-2) ' ' }
                .print-site-enumerate-headings #setup h2 {  counter-reset: counter-setup-3 ;  counter-increment: counter-setup-2 }
            
                .print-site-enumerate-headings #setup h3:before { content: '3.' counter(counter-setup-2) '.' counter(counter-setup-3) ' ' }
                .print-site-enumerate-headings #setup h3 {  counter-increment: counter-setup-3 }
            
.print-site-enumerate-headings #standards > h1:before { content: '4 ' }

                .print-site-enumerate-headings #standards h2:before { content: '4.' counter(counter-standards-2) ' ' }
                .print-site-enumerate-headings #standards h2 {  counter-reset: counter-standards-3 ;  counter-increment: counter-standards-2 }
            
                .print-site-enumerate-headings #standards h3:before { content: '4.' counter(counter-standards-2) '.' counter(counter-standards-3) ' ' }
                .print-site-enumerate-headings #standards h3 {  counter-increment: counter-standards-3 }
            
.print-site-enumerate-headings #section-5 > h1:before { content: '5 ' }
.print-site-enumerate-headings #publishing > h1:before { content: '5.1 ' }

                .print-site-enumerate-headings #publishing h2:before { content: '5.1.' counter(counter-publishing-2) ' ' }
                .print-site-enumerate-headings #publishing h2 {  counter-increment: counter-publishing-2 }
            
.print-site-enumerate-headings #publishing-first > h1:before { content: '5.2 ' }

                .print-site-enumerate-headings #publishing-first h2:before { content: '5.2.' counter(counter-publishing-first-2) ' ' }
                .print-site-enumerate-headings #publishing-first h2 {  counter-increment: counter-publishing-first-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-features > h1:before { content: '5.3 ' }

                .print-site-enumerate-headings #publishing-ogcapi-features h2:before { content: '5.3.' counter(counter-publishing-ogcapi-features-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-features h2 {  counter-increment: counter-publishing-ogcapi-features-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-coverages > h1:before { content: '5.4 ' }

                .print-site-enumerate-headings #publishing-ogcapi-coverages h2:before { content: '5.4.' counter(counter-publishing-ogcapi-coverages-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-coverages h2 {  counter-increment: counter-publishing-ogcapi-coverages-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-maps > h1:before { content: '5.5 ' }

                .print-site-enumerate-headings #publishing-ogcapi-maps h2:before { content: '5.5.' counter(counter-publishing-ogcapi-maps-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-maps h2 {  counter-increment: counter-publishing-ogcapi-maps-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-tiles > h1:before { content: '5.6 ' }

                .print-site-enumerate-headings #publishing-ogcapi-tiles h2:before { content: '5.6.' counter(counter-publishing-ogcapi-tiles-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-tiles h2 {  counter-increment: counter-publishing-ogcapi-tiles-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-records > h1:before { content: '5.7 ' }

                .print-site-enumerate-headings #publishing-ogcapi-records h2:before { content: '5.7.' counter(counter-publishing-ogcapi-records-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-records h2 {  counter-increment: counter-publishing-ogcapi-records-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-edr > h1:before { content: '5.8 ' }

                .print-site-enumerate-headings #publishing-ogcapi-edr h2:before { content: '5.8.' counter(counter-publishing-ogcapi-edr-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-edr h2 {  counter-increment: counter-publishing-ogcapi-edr-2 }
            
.print-site-enumerate-headings #publishing-ogcapi-processes > h1:before { content: '5.9 ' }

                .print-site-enumerate-headings #publishing-ogcapi-processes h2:before { content: '5.9.' counter(counter-publishing-ogcapi-processes-2) ' ' }
                .print-site-enumerate-headings #publishing-ogcapi-processes h2 {  counter-increment: counter-publishing-ogcapi-processes-2 }
            
.print-site-enumerate-headings #section-6 > h1:before { content: '6 ' }
.print-site-enumerate-headings #advanced > h1:before { content: '6.1 ' }

                .print-site-enumerate-headings #advanced h2:before { content: '6.1.' counter(counter-advanced-2) ' ' }
                .print-site-enumerate-headings #advanced h2 {  counter-increment: counter-advanced-2 }
            
.print-site-enumerate-headings #advanced-i18n > h1:before { content: '6.2 ' }

                .print-site-enumerate-headings #advanced-i18n h2:before { content: '6.2.' counter(counter-advanced-i18n-2) ' ' }
                .print-site-enumerate-headings #advanced-i18n h2 {  counter-increment: counter-advanced-i18n-2 }
            
.print-site-enumerate-headings #advanced-crs > h1:before { content: '6.3 ' }

                .print-site-enumerate-headings #advanced-crs h2:before { content: '6.3.' counter(counter-advanced-crs-2) ' ' }
                .print-site-enumerate-headings #advanced-crs h2 {  counter-increment: counter-advanced-crs-2 }
            
.print-site-enumerate-headings #advanced-ui-custom-templates > h1:before { content: '6.4 ' }

                .print-site-enumerate-headings #advanced-ui-custom-templates h2:before { content: '6.4.' counter(counter-advanced-ui-custom-templates-2) ' ' }
                .print-site-enumerate-headings #advanced-ui-custom-templates h2 {  counter-increment: counter-advanced-ui-custom-templates-2 }
            
.print-site-enumerate-headings #advanced-downstream-applications > h1:before { content: '6.5 ' }

                .print-site-enumerate-headings #advanced-downstream-applications h2:before { content: '6.5.' counter(counter-advanced-downstream-applications-2) ' ' }
                .print-site-enumerate-headings #advanced-downstream-applications h2 {  counter-increment: counter-advanced-downstream-applications-2 }
            
.print-site-enumerate-headings #advanced-seo > h1:before { content: '6.6 ' }

                .print-site-enumerate-headings #advanced-seo h2:before { content: '6.6.' counter(counter-advanced-seo-2) ' ' }
                .print-site-enumerate-headings #advanced-seo h2 {  counter-increment: counter-advanced-seo-2 }
            
.print-site-enumerate-headings #advanced-security-access-control > h1:before { content: '6.7 ' }

                .print-site-enumerate-headings #advanced-security-access-control h2:before { content: '6.7.' counter(counter-advanced-security-access-control-2) ' ' }
                .print-site-enumerate-headings #advanced-security-access-control h2 {  counter-increment: counter-advanced-security-access-control-2 }
            
.print-site-enumerate-headings #advanced-semantic-web-linked-data > h1:before { content: '6.8 ' }

                .print-site-enumerate-headings #advanced-semantic-web-linked-data h2:before { content: '6.8.' counter(counter-advanced-semantic-web-linked-data-2) ' ' }
                .print-site-enumerate-headings #advanced-semantic-web-linked-data h2 {  counter-increment: counter-advanced-semantic-web-linked-data-2 }
            
.print-site-enumerate-headings #advanced-cloud > h1:before { content: '6.9 ' }

                .print-site-enumerate-headings #advanced-cloud h2:before { content: '6.9.' counter(counter-advanced-cloud-2) ' ' }
                .print-site-enumerate-headings #advanced-cloud h2 {  counter-increment: counter-advanced-cloud-2 }
            
.print-site-enumerate-headings #advanced-inspire > h1:before { content: '6.10 ' }

                .print-site-enumerate-headings #advanced-inspire h2:before { content: '6.10.' counter(counter-advanced-inspire-2) ' ' }
                .print-site-enumerate-headings #advanced-inspire h2 {  counter-increment: counter-advanced-inspire-2 }
            
.print-site-enumerate-headings #advanced-administration > h1:before { content: '6.11 ' }

                .print-site-enumerate-headings #advanced-administration h2:before { content: '6.11.' counter(counter-advanced-administration-2) ' ' }
                .print-site-enumerate-headings #advanced-administration h2 {  counter-increment: counter-advanced-administration-2 }
            
.print-site-enumerate-headings #advanced-bridges > h1:before { content: '6.12 ' }

                .print-site-enumerate-headings #advanced-bridges h2:before { content: '6.12.' counter(counter-advanced-bridges-2) ' ' }
                .print-site-enumerate-headings #advanced-bridges h2 {  counter-increment: counter-advanced-bridges-2 }
            
.print-site-enumerate-headings #conclusion > h1:before { content: '7 ' }

                .print-site-enumerate-headings #conclusion h2:before { content: '7.' counter(counter-conclusion-2) ' ' }
                .print-site-enumerate-headings #conclusion h2 {  counter-reset: counter-conclusion-3 ;  counter-increment: counter-conclusion-2 }
            
                .print-site-enumerate-headings #conclusion h3:before { content: '7.' counter(counter-conclusion-2) '.' counter(counter-conclusion-3) ' ' }
                .print-site-enumerate-headings #conclusion h3 {  counter-increment: counter-conclusion-3 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 pygeoapi community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/diving-into-pygeoapi/", "features": ["navigation.indexes"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../assets/javascripts/termynal.js"></script>
      
        <script src="../assets/javascripts/custom.js"></script>
      
    
  </body>
</html>